2024-12-01 14:55:04,026 - __main__ - INFO - Application started and logging configured.
2024-12-01 14:55:08,440 - __main__ - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x10453e580>
2024-12-01 14:55:08,440 - __main__ - INFO - Starting processing for system: PRE
2024-12-01 14:55:08,440 - __main__ - INFO - Starting local material processing.
2024-12-01 14:55:08,440 - __main__ - INFO - Creating dataframes.
2024-12-01 14:55:08,440 - __main__ - INFO - Creating required dataframes for local material processing.
2024-12-01 14:55:08,440 - __main__ - INFO - Starting creation of required DataFrames
2024-12-01 14:55:08,440 - __main__ - INFO - Creating DataFrame for table: MARA
2024-12-01 14:55:08,440 - __main__ - INFO - Schema retrieved for table: MARA
2024-12-01 14:55:08,440 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:10,305 - __main__ - INFO - Successfully created DataFrame for table: MARA
2024-12-01 14:55:10,305 - __main__ - INFO - Successfully created DataFrame: MARA
2024-12-01 14:55:10,305 - __main__ - INFO - Creating DataFrame for table: MARC
2024-12-01 14:55:10,305 - __main__ - INFO - Schema retrieved for table: MARC
2024-12-01 14:55:10,306 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 14:55:10,524 - __main__ - INFO - Successfully created DataFrame for table: MARC
2024-12-01 14:55:10,524 - __main__ - INFO - Successfully created DataFrame: MARC
2024-12-01 14:55:10,525 - __main__ - INFO - Creating DataFrame for table: MBEW
2024-12-01 14:55:10,525 - __main__ - INFO - Schema retrieved for table: MBEW
2024-12-01 14:55:10,525 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:10,641 - __main__ - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 14:55:10,641 - __main__ - INFO - Successfully created DataFrame: MBEW
2024-12-01 14:55:10,641 - __main__ - INFO - Creating DataFrame for table: T001W
2024-12-01 14:55:10,641 - __main__ - INFO - Schema retrieved for table: T001W
2024-12-01 14:55:10,641 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:10,722 - __main__ - INFO - Successfully created DataFrame for table: T001W
2024-12-01 14:55:10,722 - __main__ - INFO - Successfully created DataFrame: T001W
2024-12-01 14:55:10,722 - __main__ - INFO - Creating DataFrame for table: T001K
2024-12-01 14:55:10,722 - __main__ - INFO - Schema retrieved for table: T001K
2024-12-01 14:55:10,722 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:10,788 - __main__ - INFO - Successfully created DataFrame for table: T001K
2024-12-01 14:55:10,788 - __main__ - INFO - Successfully created DataFrame: T001K
2024-12-01 14:55:10,788 - __main__ - INFO - Creating DataFrame for table: T001
2024-12-01 14:55:10,788 - __main__ - INFO - Schema retrieved for table: T001
2024-12-01 14:55:10,789 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:10,825 - __main__ - INFO - Successfully created DataFrame for table: T001
2024-12-01 14:55:10,825 - __main__ - INFO - Successfully created DataFrame: T001
2024-12-01 14:55:10,825 - __main__ - INFO - Completed creation of 6 required DataFrames
2024-12-01 14:55:10,825 - __main__ - INFO - Preparing general material data.
2024-12-01 14:55:10,825 - __main__ - INFO - Starting preparation of general material data
2024-12-01 14:55:10,862 - __main__ - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 14:55:11,032 - __main__ - INFO - Filtered out materials with invalid old material numbers
2024-12-01 14:55:11,056 - __main__ - INFO - Excluded materials flagged for deletion
2024-12-01 14:55:11,082 - __main__ - INFO - Completed preparation of general material data
2024-12-01 14:55:11,082 - __main__ - INFO - Preparing material valuation data.
2024-12-01 14:55:11,082 - __main__ - INFO - Starting preparation of material valuation data
2024-12-01 14:55:11,282 - __main__ - INFO - Completed preparation of material valuation data
2024-12-01 14:55:11,282 - __main__ - INFO - Preparing plant data for material.
2024-12-01 14:55:11,282 - __main__ - INFO - Starting preparation of plant data for material
2024-12-01 14:55:11,350 - __main__ - INFO - Completed preparation of plant data for material
2024-12-01 14:55:11,350 - __main__ - INFO - Preparing plant and branches data.
2024-12-01 14:55:11,350 - __main__ - INFO - Starting preparation of plant and branches data
2024-12-01 14:55:11,373 - __main__ - INFO - Completed preparation of plant and branches data
2024-12-01 14:55:11,373 - __main__ - INFO - Preparing valuation area data.
2024-12-01 14:55:11,373 - __main__ - INFO - Starting preparation of valuation area data
2024-12-01 14:55:11,389 - __main__ - INFO - Selected 3 required columns
2024-12-01 14:55:11,397 - __main__ - INFO - Completed preparation of valuation area data
2024-12-01 14:55:11,397 - __main__ - INFO - Preparing company codes data.
2024-12-01 14:55:11,397 - __main__ - INFO - Starting preparation of company codes data
2024-12-01 14:55:11,415 - __main__ - INFO - Selected 3 required columns
2024-12-01 14:55:11,415 - __main__ - INFO - Completed preparation of company codes data
2024-12-01 14:55:11,415 - __main__ - INFO - Integrating prepared data.
2024-12-01 14:55:11,416 - __main__ - INFO - Starting integration of SAP tables
2024-12-01 14:55:11,416 - __main__ - INFO - Adding prefixes to DataFrames
2024-12-01 14:55:11,416 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:11,416 - __main__ - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 14:55:11,432 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:11,432 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:11,432 - __main__ - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 14:55:11,450 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:11,450 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:11,450 - __main__ - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 14:55:11,527 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:11,527 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:11,527 - __main__ - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 14:55:11,544 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:11,544 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:11,544 - __main__ - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 14:55:11,560 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:11,560 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:11,560 - __main__ - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 14:55:11,573 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:11,573 - __main__ - INFO - Logging columns of each prefixed DataFrame
2024-12-01 14:55:11,582 - __main__ - INFO - Joining MARC with MARA
2024-12-01 14:55:11,607 - __main__ - INFO - Successfully joined MARC with MARA
2024-12-01 14:55:11,607 - __main__ - INFO - Joining result with T001W
2024-12-01 14:55:11,637 - __main__ - INFO - Successfully joined result with T001W
2024-12-01 14:55:11,637 - __main__ - INFO - Joining result with MBEW
2024-12-01 14:55:11,670 - __main__ - INFO - Successfully joined result with MBEW
2024-12-01 14:55:11,671 - __main__ - INFO - Joining result with T001K
2024-12-01 14:55:11,701 - __main__ - INFO - Successfully joined result with T001K
2024-12-01 14:55:11,701 - __main__ - INFO - Joining result with T001
2024-12-01 14:55:11,733 - __main__ - INFO - Successfully joined result with T001
2024-12-01 14:55:11,734 - __main__ - INFO - Removing duplicate key columns
2024-12-01 14:55:11,752 - __main__ - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 14:55:11,752 - __main__ - INFO - Removing prefixes from column names
2024-12-01 14:55:11,752 - __main__ - INFO - Starting to remove prefixes from column names
2024-12-01 14:55:11,890 - __main__ - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 14:55:11,890 - __main__ - INFO - Successfully removed prefixes from column names
2024-12-01 14:55:21,277 - __main__ - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 14:55:21,278 - __main__ - INFO - Completed integration of SAP tables
2024-12-01 14:55:21,278 - __main__ - INFO - Post-processing local material.
2024-12-01 14:55:21,278 - __main__ - INFO - Starting post-processing of local material data
2024-12-01 14:55:21,464 - __main__ - INFO - Added column: mtl_plant_emd
2024-12-01 14:55:21,506 - __main__ - INFO - Added column: global_mtl_id
2024-12-01 14:55:21,506 - __main__ - INFO - Starting derivation of intra and inter primary keys
2024-12-01 14:55:21,506 - __main__ - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 14:55:21,506 - __main__ - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 14:55:21,530 - __main__ - INFO - Generated intra primary key: primary_key_intra
2024-12-01 14:55:21,547 - __main__ - INFO - Generated inter primary key: primary_key_inter
2024-12-01 14:55:21,547 - __main__ - INFO - Completed derivation of intra and inter primary keys
2024-12-01 14:55:21,547 - __main__ - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 14:55:21,547 - __main__ - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 14:55:21,583 - __main__ - INFO - Added column: no_of_duplicates
2024-12-01 14:55:24,168 - __main__ - INFO - Initial row count before dropping duplicates: 61
2024-12-01 14:55:25,610 - __main__ - INFO - Removed 0 duplicate rows
2024-12-01 14:55:25,622 - __main__ - INFO - Completed post-processing of local material data
2024-12-01 14:55:25,622 - __main__ - INFO - Validating and writing final dataframe.
2024-12-01 14:55:25,622 - __main__ - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 14:55:25,622 - __main__ - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 14:55:25,622 - __main__ - INFO - DataFrame schema matches the expected schema.
2024-12-01 14:55:30,667 - __main__ - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 14:55:30,667 - __main__ - INFO - Status of the validate and write: True
2024-12-01 14:55:30,667 - __main__ - INFO - Local Material processing complete for system: PRE
2024-12-01 14:55:30,667 - __main__ - INFO - Starting process order processing.
2024-12-01 14:55:30,667 - __main__ - INFO - Loading required dataframes.
2024-12-01 14:55:30,667 - __main__ - INFO - Creating required dataframes for process order.
2024-12-01 14:55:30,667 - __main__ - INFO - Starting creation of required DataFrames
2024-12-01 14:55:30,667 - __main__ - INFO - Creating DataFrame for table: AFKO
2024-12-01 14:55:30,667 - __main__ - INFO - Schema retrieved for table: AFKO
2024-12-01 14:55:30,667 - __main__ - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 14:55:30,900 - __main__ - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 14:55:30,900 - __main__ - INFO - Successfully created DataFrame: AFKO
2024-12-01 14:55:30,900 - __main__ - INFO - Creating DataFrame for table: AFPO
2024-12-01 14:55:30,900 - __main__ - INFO - Schema retrieved for table: AFPO
2024-12-01 14:55:30,900 - __main__ - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:30,938 - __main__ - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 14:55:30,938 - __main__ - INFO - Successfully created DataFrame: AFPO
2024-12-01 14:55:30,938 - __main__ - INFO - Creating DataFrame for table: AUFK
2024-12-01 14:55:30,938 - __main__ - INFO - Schema retrieved for table: AUFK
2024-12-01 14:55:30,938 - __main__ - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:30,961 - __main__ - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 14:55:30,961 - __main__ - INFO - Successfully created DataFrame: AUFK
2024-12-01 14:55:30,961 - __main__ - INFO - Creating DataFrame for table: MARA
2024-12-01 14:55:30,961 - __main__ - INFO - Schema retrieved for table: MARA
2024-12-01 14:55:30,961 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:30,986 - __main__ - INFO - Successfully created DataFrame for table: MARA
2024-12-01 14:55:30,986 - __main__ - INFO - Successfully created DataFrame: MARA
2024-12-01 14:55:30,986 - __main__ - INFO - Completed creation of 4 required DataFrames
2024-12-01 14:55:30,986 - __main__ - INFO - Preparing SAP order header data.
2024-12-01 14:55:30,986 - __main__ - INFO - Starting prep_sap_order_header_data function
2024-12-01 14:55:30,993 - __main__ - INFO - All required columns are present in df_afko
2024-12-01 14:55:31,045 - __main__ - INFO - Selected 18 columns from df_afko
2024-12-01 14:55:31,045 - __main__ - INFO - Creating 'start_date' column
2024-12-01 14:55:31,108 - __main__ - INFO - Created 'start_date' column
2024-12-01 14:55:31,108 - __main__ - INFO - Creating 'finish_date' column
2024-12-01 14:55:31,132 - __main__ - INFO - Created 'finish_date' column
2024-12-01 14:55:31,135 - __main__ - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 14:55:31,135 - __main__ - INFO - Preparing SAP order item data.
2024-12-01 14:55:31,135 - __main__ - INFO - Starting prep_sap_order_item function
2024-12-01 14:55:31,136 - __main__ - INFO - All required columns are present in df_afpo
2024-12-01 14:55:31,153 - __main__ - INFO - Selected 7 columns from df_afpo
2024-12-01 14:55:31,154 - __main__ - INFO - Successfully completed prep_sap_order_item function
2024-12-01 14:55:31,154 - __main__ - INFO - Preparing SAP order master data.
2024-12-01 14:55:31,154 - __main__ - INFO - Starting prep_sap_order_master_data function
2024-12-01 14:55:31,166 - __main__ - INFO - Selected 7 columns from df_aufk
2024-12-01 14:55:31,167 - __main__ - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 14:55:31,168 - __main__ - INFO - Preparing SAP general material data.
2024-12-01 14:55:31,168 - __main__ - INFO - Fetching the global material column.
2024-12-01 14:55:31,168 - __main__ - INFO - Starting prep_sap_general_material_data function
2024-12-01 14:55:31,169 - __main__ - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 14:55:31,196 - __main__ - INFO - Filtering completed
2024-12-01 14:55:31,205 - __main__ - INFO - Selected 4 columns from df_mara
2024-12-01 14:55:31,206 - __main__ - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 14:55:31,208 - __main__ - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 14:55:31,208 - __main__ - INFO - Integrating prepared data.
2024-12-01 14:55:31,208 - __main__ - INFO - Starting the integration of DataFrames.
2024-12-01 14:55:31,208 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:31,208 - __main__ - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 14:55:31,228 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:31,229 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:31,229 - __main__ - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 14:55:31,237 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:31,237 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:31,237 - __main__ - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 14:55:31,245 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:31,245 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:31,245 - __main__ - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 14:55:31,253 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:31,254 - __main__ - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 14:55:31,254 - __main__ - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 14:55:31,255 - __main__ - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 14:55:31,255 - __main__ - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 14:55:31,272 - __main__ - INFO - Join with AFPO is completed.
2024-12-01 14:55:31,284 - __main__ - INFO - Join with AUFK is completed.
2024-12-01 14:55:31,295 - __main__ - INFO - Join with MARA is completed.
2024-12-01 14:55:31,314 - __main__ - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 14:55:31,321 - __main__ - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 14:55:31,321 - __main__ - INFO - Starting to remove prefixes from column names
2024-12-01 14:55:31,545 - __main__ - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 14:55:31,545 - __main__ - INFO - Successfully removed prefixes from column names
2024-12-01 14:55:31,545 - __main__ - INFO - Removed prefixes from column names.
2024-12-01 14:55:31,545 - __main__ - INFO - Integration of DataFrames completed successfully.
2024-12-01 14:55:31,545 - __main__ - INFO - Post-processing process order.
2024-12-01 14:55:31,545 - __main__ - INFO - Starting post-processing of order data.
2024-12-01 14:55:31,545 - __main__ - INFO - Starting derivation of intra and inter primary keys
2024-12-01 14:55:31,545 - __main__ - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 14:55:31,545 - __main__ - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 14:55:31,569 - __main__ - INFO - Generated intra primary key: primary_key_intra
2024-12-01 14:55:31,586 - __main__ - INFO - Generated inter primary key: primary_key_inter
2024-12-01 14:55:31,587 - __main__ - INFO - Completed derivation of intra and inter primary keys
2024-12-01 14:55:31,627 - __main__ - INFO - Date columns are converted to date format.
2024-12-01 14:55:31,654 - __main__ - INFO - On-time flag is created.
2024-12-01 14:55:31,670 - __main__ - INFO - Actual on-time deviation column is created.
2024-12-01 14:55:31,698 - __main__ - INFO - Late delivery bucket is created.
2024-12-01 14:55:31,711 - __main__ - INFO - MTO vs MTS flag is created.
2024-12-01 14:55:31,779 - __main__ - INFO - Order timestamp columns are created.
2024-12-01 14:55:31,779 - __main__ - INFO - Post-processing of order data completed successfully.
2024-12-01 14:55:31,779 - __main__ - INFO - Validating and writing final dataframe.
2024-12-01 14:55:31,781 - __main__ - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 14:55:31,781 - __main__ - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 14:55:31,781 - __main__ - INFO - DataFrame schema matches the expected schema.
2024-12-01 14:55:36,429 - __main__ - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 14:55:36,429 - __main__ - INFO - status of validate and write: True
2024-12-01 14:55:36,429 - __main__ - INFO - Process Order processing complete for system: PRE
2024-12-01 14:55:36,429 - __main__ - INFO - Starting processing for system: PRD
2024-12-01 14:55:36,429 - __main__ - INFO - Starting local material processing.
2024-12-01 14:55:36,429 - __main__ - INFO - Creating dataframes.
2024-12-01 14:55:36,429 - __main__ - INFO - Creating required dataframes for local material processing.
2024-12-01 14:55:36,429 - __main__ - INFO - Starting creation of required DataFrames
2024-12-01 14:55:36,429 - __main__ - INFO - Creating DataFrame for table: MARA
2024-12-01 14:55:36,429 - __main__ - INFO - Schema retrieved for table: MARA
2024-12-01 14:55:36,429 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:36,706 - __main__ - INFO - Successfully created DataFrame for table: MARA
2024-12-01 14:55:36,706 - __main__ - INFO - Successfully created DataFrame: MARA
2024-12-01 14:55:36,706 - __main__ - INFO - Creating DataFrame for table: MARC
2024-12-01 14:55:36,706 - __main__ - INFO - Schema retrieved for table: MARC
2024-12-01 14:55:36,706 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 14:55:36,759 - __main__ - INFO - Successfully created DataFrame for table: MARC
2024-12-01 14:55:36,759 - __main__ - INFO - Successfully created DataFrame: MARC
2024-12-01 14:55:36,759 - __main__ - INFO - Creating DataFrame for table: MBEW
2024-12-01 14:55:36,759 - __main__ - INFO - Schema retrieved for table: MBEW
2024-12-01 14:55:36,759 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:36,782 - __main__ - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 14:55:36,782 - __main__ - INFO - Successfully created DataFrame: MBEW
2024-12-01 14:55:36,782 - __main__ - INFO - Creating DataFrame for table: T001W
2024-12-01 14:55:36,782 - __main__ - INFO - Schema retrieved for table: T001W
2024-12-01 14:55:36,782 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:36,800 - __main__ - INFO - Successfully created DataFrame for table: T001W
2024-12-01 14:55:36,800 - __main__ - INFO - Successfully created DataFrame: T001W
2024-12-01 14:55:36,800 - __main__ - INFO - Creating DataFrame for table: T001K
2024-12-01 14:55:36,800 - __main__ - INFO - Schema retrieved for table: T001K
2024-12-01 14:55:36,801 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:36,837 - __main__ - INFO - Successfully created DataFrame for table: T001K
2024-12-01 14:55:36,837 - __main__ - INFO - Successfully created DataFrame: T001K
2024-12-01 14:55:36,837 - __main__ - INFO - Creating DataFrame for table: T001
2024-12-01 14:55:36,837 - __main__ - INFO - Schema retrieved for table: T001
2024-12-01 14:55:36,837 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:36,854 - __main__ - INFO - Successfully created DataFrame for table: T001
2024-12-01 14:55:36,854 - __main__ - INFO - Successfully created DataFrame: T001
2024-12-01 14:55:36,854 - __main__ - INFO - Completed creation of 6 required DataFrames
2024-12-01 14:55:36,854 - __main__ - INFO - Preparing general material data.
2024-12-01 14:55:36,854 - __main__ - INFO - Starting preparation of general material data
2024-12-01 14:55:36,861 - __main__ - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 14:55:36,927 - __main__ - INFO - Filtered out materials with invalid old material numbers
2024-12-01 14:55:36,933 - __main__ - INFO - Excluded materials flagged for deletion
2024-12-01 14:55:36,942 - __main__ - INFO - Completed preparation of general material data
2024-12-01 14:55:36,942 - __main__ - INFO - Preparing material valuation data.
2024-12-01 14:55:36,942 - __main__ - INFO - Starting preparation of material valuation data
2024-12-01 14:55:37,024 - __main__ - INFO - Completed preparation of material valuation data
2024-12-01 14:55:37,024 - __main__ - INFO - Preparing plant data for material.
2024-12-01 14:55:37,024 - __main__ - INFO - Starting preparation of plant data for material
2024-12-01 14:55:37,041 - __main__ - INFO - Completed preparation of plant data for material
2024-12-01 14:55:37,041 - __main__ - INFO - Preparing plant and branches data.
2024-12-01 14:55:37,041 - __main__ - INFO - Starting preparation of plant and branches data
2024-12-01 14:55:37,047 - __main__ - INFO - Completed preparation of plant and branches data
2024-12-01 14:55:37,047 - __main__ - INFO - Preparing valuation area data.
2024-12-01 14:55:37,047 - __main__ - INFO - Starting preparation of valuation area data
2024-12-01 14:55:37,055 - __main__ - INFO - Selected 3 required columns
2024-12-01 14:55:37,059 - __main__ - INFO - Completed preparation of valuation area data
2024-12-01 14:55:37,059 - __main__ - INFO - Preparing company codes data.
2024-12-01 14:55:37,059 - __main__ - INFO - Starting preparation of company codes data
2024-12-01 14:55:37,064 - __main__ - INFO - Selected 3 required columns
2024-12-01 14:55:37,064 - __main__ - INFO - Completed preparation of company codes data
2024-12-01 14:55:37,064 - __main__ - INFO - Integrating prepared data.
2024-12-01 14:55:37,064 - __main__ - INFO - Starting integration of SAP tables
2024-12-01 14:55:37,064 - __main__ - INFO - Adding prefixes to DataFrames
2024-12-01 14:55:37,064 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:37,065 - __main__ - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 14:55:37,073 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:37,073 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:37,073 - __main__ - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 14:55:37,082 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:37,082 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:37,082 - __main__ - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 14:55:37,094 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:37,094 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:37,094 - __main__ - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 14:55:37,103 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:37,103 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:37,103 - __main__ - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 14:55:37,109 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:37,109 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:37,109 - __main__ - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 14:55:37,116 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:37,116 - __main__ - INFO - Logging columns of each prefixed DataFrame
2024-12-01 14:55:37,121 - __main__ - INFO - Joining MARC with MARA
2024-12-01 14:55:37,135 - __main__ - INFO - Successfully joined MARC with MARA
2024-12-01 14:55:37,135 - __main__ - INFO - Joining result with T001W
2024-12-01 14:55:37,147 - __main__ - INFO - Successfully joined result with T001W
2024-12-01 14:55:37,147 - __main__ - INFO - Joining result with MBEW
2024-12-01 14:55:37,159 - __main__ - INFO - Successfully joined result with MBEW
2024-12-01 14:55:37,159 - __main__ - INFO - Joining result with T001K
2024-12-01 14:55:37,169 - __main__ - INFO - Successfully joined result with T001K
2024-12-01 14:55:37,169 - __main__ - INFO - Joining result with T001
2024-12-01 14:55:37,180 - __main__ - INFO - Successfully joined result with T001
2024-12-01 14:55:37,180 - __main__ - INFO - Removing duplicate key columns
2024-12-01 14:55:37,188 - __main__ - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 14:55:37,188 - __main__ - INFO - Removing prefixes from column names
2024-12-01 14:55:37,188 - __main__ - INFO - Starting to remove prefixes from column names
2024-12-01 14:55:37,240 - __main__ - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 14:55:37,240 - __main__ - INFO - Successfully removed prefixes from column names
2024-12-01 14:55:38,739 - __main__ - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 14:55:38,739 - __main__ - INFO - Completed integration of SAP tables
2024-12-01 14:55:38,739 - __main__ - INFO - Post-processing local material.
2024-12-01 14:55:38,739 - __main__ - INFO - Starting post-processing of local material data
2024-12-01 14:55:38,769 - __main__ - INFO - Added column: mtl_plant_emd
2024-12-01 14:55:38,783 - __main__ - INFO - Added column: global_mtl_id
2024-12-01 14:55:38,783 - __main__ - INFO - Starting derivation of intra and inter primary keys
2024-12-01 14:55:38,783 - __main__ - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 14:55:38,783 - __main__ - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 14:55:38,793 - __main__ - INFO - Generated intra primary key: primary_key_intra
2024-12-01 14:55:38,801 - __main__ - INFO - Generated inter primary key: primary_key_inter
2024-12-01 14:55:38,801 - __main__ - INFO - Completed derivation of intra and inter primary keys
2024-12-01 14:55:38,801 - __main__ - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 14:55:38,801 - __main__ - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 14:55:38,817 - __main__ - INFO - Added column: no_of_duplicates
2024-12-01 14:55:40,641 - __main__ - INFO - Initial row count before dropping duplicates: 13
2024-12-01 14:55:41,285 - __main__ - INFO - Removed 0 duplicate rows
2024-12-01 14:55:41,292 - __main__ - INFO - Completed post-processing of local material data
2024-12-01 14:55:41,292 - __main__ - INFO - Validating and writing final dataframe.
2024-12-01 14:55:41,292 - __main__ - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 14:55:41,292 - __main__ - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 14:55:41,292 - __main__ - INFO - DataFrame schema matches the expected schema.
2024-12-01 14:55:43,419 - __main__ - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 14:55:43,419 - __main__ - INFO - Status of the validate and write: True
2024-12-01 14:55:43,419 - __main__ - INFO - Local Material processing complete for system: PRD
2024-12-01 14:55:43,419 - __main__ - INFO - Starting process order processing.
2024-12-01 14:55:43,419 - __main__ - INFO - Loading required dataframes.
2024-12-01 14:55:43,419 - __main__ - INFO - Creating required dataframes for process order.
2024-12-01 14:55:43,419 - __main__ - INFO - Starting creation of required DataFrames
2024-12-01 14:55:43,419 - __main__ - INFO - Creating DataFrame for table: AFKO
2024-12-01 14:55:43,419 - __main__ - INFO - Schema retrieved for table: AFKO
2024-12-01 14:55:43,419 - __main__ - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 14:55:43,551 - __main__ - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 14:55:43,551 - __main__ - INFO - Successfully created DataFrame: AFKO
2024-12-01 14:55:43,551 - __main__ - INFO - Creating DataFrame for table: AFPO
2024-12-01 14:55:43,551 - __main__ - INFO - Schema retrieved for table: AFPO
2024-12-01 14:55:43,551 - __main__ - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 14:55:43,579 - __main__ - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 14:55:43,580 - __main__ - INFO - Successfully created DataFrame: AFPO
2024-12-01 14:55:43,580 - __main__ - INFO - Creating DataFrame for table: AUFK
2024-12-01 14:55:43,580 - __main__ - INFO - Schema retrieved for table: AUFK
2024-12-01 14:55:43,580 - __main__ - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:43,599 - __main__ - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 14:55:43,599 - __main__ - INFO - Successfully created DataFrame: AUFK
2024-12-01 14:55:43,599 - __main__ - INFO - Creating DataFrame for table: MARA
2024-12-01 14:55:43,599 - __main__ - INFO - Schema retrieved for table: MARA
2024-12-01 14:55:43,600 - __main__ - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 14:55:43,625 - __main__ - INFO - Successfully created DataFrame for table: MARA
2024-12-01 14:55:43,625 - __main__ - INFO - Successfully created DataFrame: MARA
2024-12-01 14:55:43,625 - __main__ - INFO - Completed creation of 4 required DataFrames
2024-12-01 14:55:43,625 - __main__ - INFO - Preparing SAP order header data.
2024-12-01 14:55:43,625 - __main__ - INFO - Starting prep_sap_order_header_data function
2024-12-01 14:55:43,627 - __main__ - INFO - All required columns are present in df_afko
2024-12-01 14:55:43,663 - __main__ - INFO - Selected 18 columns from df_afko
2024-12-01 14:55:43,663 - __main__ - INFO - Creating 'start_date' column
2024-12-01 14:55:43,700 - __main__ - INFO - Created 'start_date' column
2024-12-01 14:55:43,701 - __main__ - INFO - Creating 'finish_date' column
2024-12-01 14:55:43,718 - __main__ - INFO - Created 'finish_date' column
2024-12-01 14:55:43,718 - __main__ - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 14:55:43,718 - __main__ - INFO - Preparing SAP order item data.
2024-12-01 14:55:43,718 - __main__ - INFO - Starting prep_sap_order_item function
2024-12-01 14:55:43,719 - __main__ - INFO - All required columns are present in df_afpo
2024-12-01 14:55:43,728 - __main__ - INFO - Selected 7 columns from df_afpo
2024-12-01 14:55:43,729 - __main__ - INFO - Successfully completed prep_sap_order_item function
2024-12-01 14:55:43,729 - __main__ - INFO - Preparing SAP order master data.
2024-12-01 14:55:43,729 - __main__ - INFO - Starting prep_sap_order_master_data function
2024-12-01 14:55:43,740 - __main__ - INFO - Selected 7 columns from df_aufk
2024-12-01 14:55:43,741 - __main__ - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 14:55:43,741 - __main__ - INFO - Preparing SAP general material data.
2024-12-01 14:55:43,741 - __main__ - INFO - Fetching the global material column.
2024-12-01 14:55:43,741 - __main__ - INFO - Starting prep_sap_general_material_data function
2024-12-01 14:55:43,742 - __main__ - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 14:55:43,768 - __main__ - INFO - Filtering completed
2024-12-01 14:55:43,781 - __main__ - INFO - Selected 4 columns from df_mara
2024-12-01 14:55:43,784 - __main__ - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 14:55:43,784 - __main__ - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 14:55:43,784 - __main__ - INFO - Integrating prepared data.
2024-12-01 14:55:43,784 - __main__ - INFO - Starting the integration of DataFrames.
2024-12-01 14:55:43,784 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:43,784 - __main__ - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 14:55:43,809 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:43,809 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:43,809 - __main__ - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 14:55:43,818 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:43,818 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:43,818 - __main__ - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 14:55:43,829 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:43,830 - __main__ - INFO - Starting prefixing columns
2024-12-01 14:55:43,830 - __main__ - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 14:55:43,838 - __main__ - INFO - Successfully prefixed columns
2024-12-01 14:55:43,838 - __main__ - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 14:55:43,839 - __main__ - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 14:55:43,839 - __main__ - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 14:55:43,840 - __main__ - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 14:55:43,852 - __main__ - INFO - Join with AFPO is completed.
2024-12-01 14:55:43,863 - __main__ - INFO - Join with AUFK is completed.
2024-12-01 14:55:43,870 - __main__ - INFO - Join with MARA is completed.
2024-12-01 14:55:43,879 - __main__ - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 14:55:43,884 - __main__ - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 14:55:43,884 - __main__ - INFO - Starting to remove prefixes from column names
2024-12-01 14:55:44,072 - __main__ - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 14:55:44,072 - __main__ - INFO - Successfully removed prefixes from column names
2024-12-01 14:55:44,072 - __main__ - INFO - Removed prefixes from column names.
2024-12-01 14:55:44,072 - __main__ - INFO - Integration of DataFrames completed successfully.
2024-12-01 14:55:44,072 - __main__ - INFO - Post-processing process order.
2024-12-01 14:55:44,072 - __main__ - INFO - Starting post-processing of order data.
2024-12-01 14:55:44,072 - __main__ - INFO - Starting derivation of intra and inter primary keys
2024-12-01 14:55:44,072 - __main__ - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 14:55:44,072 - __main__ - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 14:55:44,087 - __main__ - INFO - Generated intra primary key: primary_key_intra
2024-12-01 14:55:44,102 - __main__ - INFO - Generated inter primary key: primary_key_inter
2024-12-01 14:55:44,102 - __main__ - INFO - Completed derivation of intra and inter primary keys
2024-12-01 14:55:44,132 - __main__ - INFO - Date columns are converted to date format.
2024-12-01 14:55:44,156 - __main__ - INFO - On-time flag is created.
2024-12-01 14:55:44,173 - __main__ - INFO - Actual on-time deviation column is created.
2024-12-01 14:55:44,191 - __main__ - INFO - Late delivery bucket is created.
2024-12-01 14:55:44,207 - __main__ - INFO - MTO vs MTS flag is created.
2024-12-01 14:55:44,242 - __main__ - INFO - Order timestamp columns are created.
2024-12-01 14:55:44,242 - __main__ - INFO - Post-processing of order data completed successfully.
2024-12-01 14:55:44,242 - __main__ - INFO - Validating and writing final dataframe.
2024-12-01 14:55:44,243 - __main__ - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 14:55:44,243 - __main__ - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 14:55:44,243 - __main__ - INFO - DataFrame schema matches the expected schema.
2024-12-01 14:55:45,077 - __main__ - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 14:55:45,077 - __main__ - INFO - status of validate and write: True
2024-12-01 14:55:45,077 - __main__ - INFO - Process Order processing complete for system: PRD
2024-12-01 14:55:45,077 - __main__ - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 14:55:45,077 - __main__ - INFO - Schema matched.
2024-12-01 14:55:45,188 - __main__ - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 14:55:45,188 - __main__ - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 14:55:48,505 - __main__ - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 14:55:48,505 - __main__ - INFO - Harmonization of Local Material data was successful.
2024-12-01 14:55:48,505 - __main__ - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 14:55:48,505 - __main__ - INFO - Schema matched.
2024-12-01 14:55:48,634 - __main__ - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 14:55:48,634 - __main__ - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 14:55:51,774 - __main__ - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 14:55:51,774 - __main__ - INFO - Harmonization of Process Order data was successful.
2024-12-01 14:55:51,774 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-01 15:08:48,256 - code.main - INFO - Application started and logging configured.
2024-12-01 15:08:52,980 - code.main - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x105f91730>
2024-12-01 15:08:52,981 - code.main - INFO - Starting processing for system: PRE
2024-12-01 15:08:52,981 - code.main - INFO - Starting local material processing.
2024-12-01 15:08:52,981 - code.main - INFO - Creating dataframes.
2024-12-01 15:08:52,981 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:08:52,981 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:08:52,981 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:08:52,981 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:08:52,981 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:08:54,874 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:08:54,874 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:08:54,874 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:08:54,874 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:08:54,874 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:08:55,099 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:08:55,099 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:08:55,099 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:08:55,099 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:08:55,099 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:08:55,205 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:08:55,205 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:08:55,205 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:08:55,205 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:08:55,205 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:08:55,282 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:08:55,282 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:08:55,282 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:08:55,282 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:08:55,282 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:08:55,347 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:08:55,347 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:08:55,347 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:08:55,348 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:08:55,348 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:08:55,385 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:08:55,385 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:08:55,385 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:08:55,385 - code.main - INFO - Preparing general material data.
2024-12-01 15:08:55,385 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:08:55,422 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:08:55,592 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:08:55,617 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:08:55,649 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:08:55,649 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:08:55,649 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:08:55,885 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:08:55,885 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:08:55,885 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:08:55,940 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:08:55,940 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:08:55,940 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:08:55,962 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:08:55,962 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:08:55,962 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:08:55,975 - code.main - INFO - Selected 3 required columns
2024-12-01 15:08:55,983 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:08:55,983 - code.main - INFO - Preparing company codes data.
2024-12-01 15:08:55,983 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:08:56,005 - code.main - INFO - Selected 3 required columns
2024-12-01 15:08:56,005 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:08:56,005 - code.main - INFO - Integrating prepared data.
2024-12-01 15:08:56,005 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:08:56,005 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:08:56,005 - code.main - INFO - Starting prefixing columns
2024-12-01 15:08:56,005 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:08:56,026 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:08:56,026 - code.main - INFO - Starting prefixing columns
2024-12-01 15:08:56,026 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:08:56,086 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:08:56,086 - code.main - INFO - Starting prefixing columns
2024-12-01 15:08:56,086 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:08:56,120 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:08:56,120 - code.main - INFO - Starting prefixing columns
2024-12-01 15:08:56,120 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:08:56,131 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:08:56,131 - code.main - INFO - Starting prefixing columns
2024-12-01 15:08:56,131 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:08:56,145 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:08:56,145 - code.main - INFO - Starting prefixing columns
2024-12-01 15:08:56,145 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:08:56,156 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:08:56,156 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:08:56,166 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:08:56,196 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:08:56,196 - code.main - INFO - Joining result with T001W
2024-12-01 15:08:56,226 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:08:56,226 - code.main - INFO - Joining result with MBEW
2024-12-01 15:08:56,281 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:08:56,281 - code.main - INFO - Joining result with T001K
2024-12-01 15:08:56,315 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:08:56,315 - code.main - INFO - Joining result with T001
2024-12-01 15:08:56,353 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:08:56,353 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:08:56,375 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:08:56,375 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:08:56,375 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:08:56,516 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:08:56,516 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:09:06,192 - code.main - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 15:09:06,192 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:09:06,192 - code.main - INFO - Post-processing local material.
2024-12-01 15:09:06,192 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:09:06,367 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:09:06,408 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:09:06,408 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:09:06,408 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:09:06,408 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:09:06,433 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:09:06,452 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:09:06,452 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:09:06,452 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:09:06,452 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:09:06,487 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:09:08,696 - code.main - INFO - Initial row count before dropping duplicates: 61
2024-12-01 15:09:10,768 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:09:10,798 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:09:10,798 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:09:10,798 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:09:10,798 - code.main - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 15:09:10,798 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:09:15,214 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 15:09:15,214 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:09:15,214 - code.main - INFO - Local Material processing complete for system: PRE
2024-12-01 15:09:15,214 - code.main - INFO - Starting process order processing.
2024-12-01 15:09:15,214 - code.main - INFO - Loading required dataframes.
2024-12-01 15:09:15,214 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:09:15,214 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:09:15,214 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:09:15,214 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:09:15,214 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:09:15,350 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:09:15,350 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:09:15,350 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:09:15,350 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:09:15,350 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:15,382 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:09:15,382 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:09:15,382 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:09:15,382 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:09:15,382 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:15,407 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:09:15,407 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:09:15,407 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:09:15,407 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:09:15,408 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:15,430 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:09:15,430 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:09:15,430 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:09:15,430 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:09:15,430 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:09:15,434 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:09:15,469 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:09:15,469 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:09:15,517 - code.main - INFO - Created 'start_date' column
2024-12-01 15:09:15,517 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:09:15,537 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:09:15,540 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:09:15,540 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:09:15,540 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:09:15,542 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:09:15,559 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:09:15,561 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:09:15,561 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:09:15,561 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:09:15,572 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:09:15,573 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:09:15,573 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:09:15,573 - code.main - INFO - Fetching the global material column.
2024-12-01 15:09:15,573 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:09:15,574 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:09:15,595 - code.main - INFO - Filtering completed
2024-12-01 15:09:15,603 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:09:15,606 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:09:15,609 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:09:15,609 - code.main - INFO - Integrating prepared data.
2024-12-01 15:09:15,609 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:09:15,609 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:15,609 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:09:15,633 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:15,633 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:15,633 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:09:15,642 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:15,642 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:15,642 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:09:15,651 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:15,651 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:15,651 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:09:15,658 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:15,659 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:09:15,660 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:09:15,660 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:09:15,660 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:09:15,673 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:09:15,681 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:09:15,691 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:09:15,704 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:09:15,711 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:09:15,711 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:09:15,909 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:09:15,909 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:09:15,909 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:09:15,909 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:09:15,909 - code.main - INFO - Post-processing process order.
2024-12-01 15:09:15,909 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:09:15,909 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:09:15,909 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:09:15,909 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:09:15,937 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:09:15,953 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:09:15,954 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:09:15,998 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:09:16,032 - code.main - INFO - On-time flag is created.
2024-12-01 15:09:16,071 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:09:16,103 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:09:16,120 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:09:16,191 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:09:16,191 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:09:16,191 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:09:16,193 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:09:16,193 - code.main - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:09:16,193 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:09:20,481 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 15:09:20,481 - code.main - INFO - status of validate and write: True
2024-12-01 15:09:20,482 - code.main - INFO - Process Order processing complete for system: PRE
2024-12-01 15:09:20,482 - code.main - INFO - Starting processing for system: PRD
2024-12-01 15:09:20,482 - code.main - INFO - Starting local material processing.
2024-12-01 15:09:20,482 - code.main - INFO - Creating dataframes.
2024-12-01 15:09:20,482 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:09:20,482 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:09:20,482 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:09:20,482 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:09:20,482 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:20,735 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:09:20,735 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:09:20,735 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:09:20,735 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:09:20,735 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:09:20,791 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:09:20,791 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:09:20,791 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:09:20,791 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:09:20,791 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:20,814 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:09:20,814 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:09:20,814 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:09:20,814 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:09:20,814 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:20,828 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:09:20,828 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:09:20,829 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:09:20,829 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:09:20,829 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:20,862 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:09:20,862 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:09:20,862 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:09:20,862 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:09:20,862 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:20,885 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:09:20,885 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:09:20,885 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:09:20,885 - code.main - INFO - Preparing general material data.
2024-12-01 15:09:20,885 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:09:20,892 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:09:20,956 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:09:20,965 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:09:20,971 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:09:20,971 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:09:20,971 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:09:21,043 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:09:21,043 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:09:21,043 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:09:21,058 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:09:21,058 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:09:21,058 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:09:21,065 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:09:21,065 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:09:21,065 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:09:21,072 - code.main - INFO - Selected 3 required columns
2024-12-01 15:09:21,075 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:09:21,075 - code.main - INFO - Preparing company codes data.
2024-12-01 15:09:21,075 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:09:21,082 - code.main - INFO - Selected 3 required columns
2024-12-01 15:09:21,082 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:09:21,082 - code.main - INFO - Integrating prepared data.
2024-12-01 15:09:21,082 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:09:21,082 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:09:21,082 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:21,082 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:09:21,088 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:21,088 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:21,088 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:09:21,096 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:21,096 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:21,096 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:09:21,107 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:21,107 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:21,107 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:09:21,117 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:21,117 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:21,117 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:09:21,125 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:21,125 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:21,125 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:09:21,132 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:21,132 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:09:21,135 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:09:21,149 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:09:21,149 - code.main - INFO - Joining result with T001W
2024-12-01 15:09:21,158 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:09:21,158 - code.main - INFO - Joining result with MBEW
2024-12-01 15:09:21,169 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:09:21,169 - code.main - INFO - Joining result with T001K
2024-12-01 15:09:21,179 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:09:21,179 - code.main - INFO - Joining result with T001
2024-12-01 15:09:21,192 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:09:21,192 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:09:21,200 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:09:21,200 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:09:21,200 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:09:21,254 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:09:21,254 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:09:24,217 - code.main - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 15:09:24,217 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:09:24,217 - code.main - INFO - Post-processing local material.
2024-12-01 15:09:24,217 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:09:24,382 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:09:24,403 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:09:24,403 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:09:24,403 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:09:24,403 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:09:24,417 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:09:24,426 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:09:24,426 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:09:24,426 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:09:24,426 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:09:24,450 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:09:25,081 - code.main - INFO - Initial row count before dropping duplicates: 13
2024-12-01 15:09:25,397 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:09:25,398 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:09:25,398 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:09:25,398 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:09:25,398 - code.main - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 15:09:25,398 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:09:28,118 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 15:09:28,118 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:09:28,118 - code.main - INFO - Local Material processing complete for system: PRD
2024-12-01 15:09:28,118 - code.main - INFO - Starting process order processing.
2024-12-01 15:09:28,118 - code.main - INFO - Loading required dataframes.
2024-12-01 15:09:28,118 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:09:28,118 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:09:28,118 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:09:28,118 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:09:28,118 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:09:28,242 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:09:28,242 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:09:28,242 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:09:28,242 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:09:28,242 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:09:28,271 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:09:28,271 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:09:28,271 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:09:28,271 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:09:28,271 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:28,292 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:09:28,292 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:09:28,292 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:09:28,292 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:09:28,292 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:09:28,314 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:09:28,314 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:09:28,314 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:09:28,314 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:09:28,314 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:09:28,316 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:09:28,350 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:09:28,350 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:09:28,386 - code.main - INFO - Created 'start_date' column
2024-12-01 15:09:28,386 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:09:28,406 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:09:28,406 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:09:28,407 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:09:28,407 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:09:28,408 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:09:28,419 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:09:28,419 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:09:28,419 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:09:28,419 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:09:28,433 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:09:28,434 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:09:28,434 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:09:28,434 - code.main - INFO - Fetching the global material column.
2024-12-01 15:09:28,434 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:09:28,436 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:09:28,459 - code.main - INFO - Filtering completed
2024-12-01 15:09:28,467 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:09:28,470 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:09:28,471 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:09:28,471 - code.main - INFO - Integrating prepared data.
2024-12-01 15:09:28,471 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:09:28,471 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:28,471 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:09:28,494 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:28,494 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:28,494 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:09:28,505 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:28,505 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:28,505 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:09:28,515 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:28,515 - code.main - INFO - Starting prefixing columns
2024-12-01 15:09:28,515 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:09:28,524 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:09:28,524 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:09:28,525 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:09:28,525 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:09:28,525 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:09:28,536 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:09:28,545 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:09:28,552 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:09:28,561 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:09:28,567 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:09:28,567 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:09:28,727 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:09:28,727 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:09:28,727 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:09:28,727 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:09:28,727 - code.main - INFO - Post-processing process order.
2024-12-01 15:09:28,727 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:09:28,727 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:09:28,727 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:09:28,727 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:09:28,744 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:09:28,760 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:09:28,760 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:09:28,805 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:09:28,827 - code.main - INFO - On-time flag is created.
2024-12-01 15:09:28,843 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:09:28,858 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:09:28,874 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:09:28,906 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:09:28,906 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:09:28,906 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:09:28,907 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:09:28,907 - code.main - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:09:28,907 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:09:31,132 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 15:09:31,132 - code.main - INFO - status of validate and write: True
2024-12-01 15:09:31,132 - code.main - INFO - Process Order processing complete for system: PRD
2024-12-01 15:09:31,132 - code.main - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 15:09:31,132 - code.main - INFO - Schema matched.
2024-12-01 15:09:31,345 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:09:31,345 - code.main - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 15:09:34,963 - code.main - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 15:09:34,963 - code.main - INFO - Harmonization of Local Material data was successful.
2024-12-01 15:09:34,963 - code.main - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 15:09:34,963 - code.main - INFO - Schema matched.
2024-12-01 15:09:35,090 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:09:35,090 - code.main - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 15:09:38,205 - code.main - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 15:09:38,205 - code.main - INFO - Harmonization of Process Order data was successful.
2024-12-01 15:09:38,205 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-01 15:10:22,968 - code.main - INFO - Application started and logging configured.
2024-12-01 15:10:27,078 - code.main - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x1057556a0>
2024-12-01 15:10:27,078 - code.main - INFO - Starting processing for system: PRE
2024-12-01 15:10:27,078 - code.main - INFO - Starting local material processing.
2024-12-01 15:10:27,078 - code.main - INFO - Creating dataframes.
2024-12-01 15:10:27,078 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:10:27,078 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:10:27,078 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:10:27,078 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:10:27,078 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:28,880 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:10:28,880 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:10:28,881 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:10:28,881 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:10:28,881 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:10:29,105 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:10:29,105 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:10:29,105 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:10:29,105 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:10:29,105 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:29,224 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:10:29,224 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:10:29,224 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:10:29,224 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:10:29,224 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:29,295 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:10:29,295 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:10:29,295 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:10:29,295 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:10:29,295 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:29,367 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:10:29,367 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:10:29,367 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:10:29,367 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:10:29,367 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:29,407 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:10:29,407 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:10:29,407 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:10:29,407 - code.main - INFO - Preparing general material data.
2024-12-01 15:10:29,407 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:10:29,447 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:10:29,617 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:10:29,643 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:10:29,673 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:10:29,673 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:10:29,673 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:10:29,877 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:10:29,877 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:10:29,877 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:10:29,940 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:10:29,940 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:10:29,940 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:10:29,961 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:10:29,961 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:10:29,961 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:10:29,975 - code.main - INFO - Selected 3 required columns
2024-12-01 15:10:29,982 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:10:29,982 - code.main - INFO - Preparing company codes data.
2024-12-01 15:10:29,982 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:10:30,002 - code.main - INFO - Selected 3 required columns
2024-12-01 15:10:30,003 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:10:30,003 - code.main - INFO - Integrating prepared data.
2024-12-01 15:10:30,003 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:10:30,003 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:10:30,003 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:30,003 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:10:30,020 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:30,020 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:30,020 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:10:30,032 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:30,032 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:30,032 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:10:30,097 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:30,097 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:30,097 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:10:30,126 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:30,126 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:30,126 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:10:30,138 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:30,138 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:30,138 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:10:30,151 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:30,151 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:10:30,157 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:10:30,185 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:10:30,185 - code.main - INFO - Joining result with T001W
2024-12-01 15:10:30,214 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:10:30,214 - code.main - INFO - Joining result with MBEW
2024-12-01 15:10:30,261 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:10:30,261 - code.main - INFO - Joining result with T001K
2024-12-01 15:10:30,294 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:10:30,294 - code.main - INFO - Joining result with T001
2024-12-01 15:10:30,328 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:10:30,328 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:10:30,348 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:10:30,348 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:10:30,348 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:10:30,493 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:10:30,493 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:10:39,527 - code.main - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 15:10:39,527 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:10:39,527 - code.main - INFO - Post-processing local material.
2024-12-01 15:10:39,527 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:10:39,757 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:10:39,794 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:10:39,794 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:10:39,794 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:10:39,794 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:10:39,818 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:10:39,835 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:10:39,835 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:10:39,835 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:10:39,835 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:10:39,873 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:10:42,209 - code.main - INFO - Initial row count before dropping duplicates: 61
2024-12-01 15:10:43,138 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:10:43,151 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:10:43,151 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:10:43,151 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:10:43,151 - code.main - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 15:10:43,151 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:10:48,509 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 15:10:48,509 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:10:48,509 - code.main - INFO - Local Material processing complete for system: PRE
2024-12-01 15:10:48,509 - code.main - INFO - Starting process order processing.
2024-12-01 15:10:48,510 - code.main - INFO - Loading required dataframes.
2024-12-01 15:10:48,510 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:10:48,510 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:10:48,510 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:10:48,510 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:10:48,510 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:10:48,673 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:10:48,673 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:10:48,673 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:10:48,673 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:10:48,673 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:48,708 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:10:48,708 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:10:48,708 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:10:48,708 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:10:48,708 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:48,730 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:10:48,730 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:10:48,730 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:10:48,730 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:10:48,730 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:48,753 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:10:48,753 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:10:48,753 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:10:48,753 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:10:48,753 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:10:48,757 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:10:48,800 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:10:48,800 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:10:48,861 - code.main - INFO - Created 'start_date' column
2024-12-01 15:10:48,861 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:10:48,883 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:10:48,885 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:10:48,885 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:10:48,885 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:10:48,886 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:10:48,900 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:10:48,900 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:10:48,900 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:10:48,901 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:10:48,913 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:10:48,914 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:10:48,914 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:10:48,914 - code.main - INFO - Fetching the global material column.
2024-12-01 15:10:48,914 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:10:48,915 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:10:48,937 - code.main - INFO - Filtering completed
2024-12-01 15:10:48,947 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:10:48,951 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:10:48,952 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:10:48,952 - code.main - INFO - Integrating prepared data.
2024-12-01 15:10:48,952 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:10:48,952 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:48,952 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:10:48,976 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:48,976 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:48,976 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:10:48,985 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:48,985 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:48,985 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:10:48,995 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:48,995 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:48,995 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:10:49,004 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:49,005 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:10:49,005 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:10:49,005 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:10:49,006 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:10:49,019 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:10:49,027 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:10:49,037 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:10:49,056 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:10:49,065 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:10:49,065 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:10:49,276 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:10:49,277 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:10:49,277 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:10:49,277 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:10:49,277 - code.main - INFO - Post-processing process order.
2024-12-01 15:10:49,277 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:10:49,277 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:10:49,277 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:10:49,277 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:10:49,299 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:10:49,315 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:10:49,315 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:10:49,353 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:10:49,381 - code.main - INFO - On-time flag is created.
2024-12-01 15:10:49,400 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:10:49,423 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:10:49,438 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:10:49,501 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:10:49,501 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:10:49,501 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:10:49,502 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:10:49,502 - code.main - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:10:49,502 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:10:53,678 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 15:10:53,678 - code.main - INFO - status of validate and write: True
2024-12-01 15:10:53,678 - code.main - INFO - Process Order processing complete for system: PRE
2024-12-01 15:10:53,678 - code.main - INFO - Starting processing for system: PRD
2024-12-01 15:10:53,678 - code.main - INFO - Starting local material processing.
2024-12-01 15:10:53,678 - code.main - INFO - Creating dataframes.
2024-12-01 15:10:53,678 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:10:53,678 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:10:53,678 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:10:53,678 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:10:53,678 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:53,954 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:10:53,954 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:10:53,954 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:10:53,954 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:10:53,954 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:10:54,016 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:10:54,016 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:10:54,017 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:10:54,017 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:10:54,017 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:54,037 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:10:54,037 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:10:54,037 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:10:54,037 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:10:54,037 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:54,050 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:10:54,050 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:10:54,050 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:10:54,050 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:10:54,050 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:54,088 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:10:54,088 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:10:54,088 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:10:54,088 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:10:54,088 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:10:54,110 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:10:54,110 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:10:54,110 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:10:54,110 - code.main - INFO - Preparing general material data.
2024-12-01 15:10:54,110 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:10:54,117 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:10:54,183 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:10:54,189 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:10:54,195 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:10:54,195 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:10:54,195 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:10:54,271 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:10:54,271 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:10:54,271 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:10:54,290 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:10:54,290 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:10:54,290 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:10:54,299 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:10:54,299 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:10:54,299 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:10:54,305 - code.main - INFO - Selected 3 required columns
2024-12-01 15:10:54,308 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:10:54,308 - code.main - INFO - Preparing company codes data.
2024-12-01 15:10:54,308 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:10:54,315 - code.main - INFO - Selected 3 required columns
2024-12-01 15:10:54,315 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:10:54,315 - code.main - INFO - Integrating prepared data.
2024-12-01 15:10:54,315 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:10:54,315 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:10:54,315 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:54,315 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:10:54,320 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:54,320 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:54,320 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:10:54,326 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:54,327 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:54,327 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:10:54,338 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:54,339 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:54,339 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:10:54,345 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:54,345 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:54,345 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:10:54,350 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:54,350 - code.main - INFO - Starting prefixing columns
2024-12-01 15:10:54,350 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:10:54,356 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:10:54,356 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:10:54,361 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:10:54,372 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:10:54,372 - code.main - INFO - Joining result with T001W
2024-12-01 15:10:54,383 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:10:54,383 - code.main - INFO - Joining result with MBEW
2024-12-01 15:10:54,393 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:10:54,393 - code.main - INFO - Joining result with T001K
2024-12-01 15:10:54,404 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:10:54,404 - code.main - INFO - Joining result with T001
2024-12-01 15:10:54,415 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:10:54,415 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:10:54,422 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:10:54,422 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:10:54,422 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:10:54,470 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:10:54,470 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:10:55,995 - code.main - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 15:10:55,995 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:10:55,995 - code.main - INFO - Post-processing local material.
2024-12-01 15:10:55,995 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:10:56,028 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:10:56,042 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:10:56,042 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:10:56,042 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:10:56,042 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:10:56,052 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:10:56,061 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:10:56,061 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:10:56,061 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:10:56,061 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:10:56,077 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:10:57,777 - code.main - INFO - Initial row count before dropping duplicates: 13
2024-12-01 15:10:58,490 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:10:58,499 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:10:58,499 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:10:58,499 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:10:58,499 - code.main - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 15:10:58,499 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:11:00,963 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 15:11:00,963 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:11:00,963 - code.main - INFO - Local Material processing complete for system: PRD
2024-12-01 15:11:00,963 - code.main - INFO - Starting process order processing.
2024-12-01 15:11:00,963 - code.main - INFO - Loading required dataframes.
2024-12-01 15:11:00,963 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:11:00,963 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:11:00,963 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:11:00,963 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:11:00,964 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:11:01,118 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:11:01,119 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:11:01,119 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:11:01,119 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:11:01,119 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:11:01,150 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:11:01,150 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:11:01,150 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:11:01,150 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:11:01,150 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:11:01,172 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:11:01,172 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:11:01,172 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:11:01,172 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:11:01,172 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:11:01,197 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:11:01,197 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:11:01,197 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:11:01,197 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:11:01,197 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:11:01,199 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:11:01,233 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:11:01,233 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:11:01,267 - code.main - INFO - Created 'start_date' column
2024-12-01 15:11:01,267 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:11:01,283 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:11:01,284 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:11:01,284 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:11:01,284 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:11:01,285 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:11:01,294 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:11:01,294 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:11:01,294 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:11:01,294 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:11:01,309 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:11:01,309 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:11:01,309 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:11:01,309 - code.main - INFO - Fetching the global material column.
2024-12-01 15:11:01,310 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:11:01,311 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:11:01,330 - code.main - INFO - Filtering completed
2024-12-01 15:11:01,336 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:11:01,338 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:11:01,339 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:11:01,339 - code.main - INFO - Integrating prepared data.
2024-12-01 15:11:01,339 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:11:01,339 - code.main - INFO - Starting prefixing columns
2024-12-01 15:11:01,339 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:11:01,356 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:11:01,356 - code.main - INFO - Starting prefixing columns
2024-12-01 15:11:01,356 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:11:01,367 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:11:01,367 - code.main - INFO - Starting prefixing columns
2024-12-01 15:11:01,367 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:11:01,378 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:11:01,378 - code.main - INFO - Starting prefixing columns
2024-12-01 15:11:01,378 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:11:01,407 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:11:01,409 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:11:01,410 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:11:01,410 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:11:01,410 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:11:01,420 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:11:01,429 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:11:01,436 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:11:01,445 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:11:01,452 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:11:01,452 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:11:01,609 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:11:01,609 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:11:01,609 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:11:01,609 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:11:01,609 - code.main - INFO - Post-processing process order.
2024-12-01 15:11:01,609 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:11:01,609 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:11:01,609 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:11:01,609 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:11:01,625 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:11:01,639 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:11:01,639 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:11:01,674 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:11:01,701 - code.main - INFO - On-time flag is created.
2024-12-01 15:11:01,720 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:11:01,742 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:11:01,762 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:11:01,793 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:11:01,793 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:11:01,794 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:11:01,794 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:11:01,794 - code.main - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:11:01,794 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:11:03,415 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 15:11:03,415 - code.main - INFO - status of validate and write: True
2024-12-01 15:11:03,415 - code.main - INFO - Process Order processing complete for system: PRD
2024-12-01 15:11:03,415 - code.main - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 15:11:03,416 - code.main - INFO - Schema matched.
2024-12-01 15:11:03,641 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:11:03,641 - code.main - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 15:11:07,486 - code.main - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 15:11:07,486 - code.main - INFO - Harmonization of Local Material data was successful.
2024-12-01 15:11:07,486 - code.main - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 15:11:07,486 - code.main - INFO - Schema matched.
2024-12-01 15:11:07,633 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:11:07,633 - code.main - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 15:11:10,023 - code.main - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 15:11:10,023 - code.main - INFO - Harmonization of Process Order data was successful.
2024-12-01 15:11:10,023 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-01 15:14:39,751 - code.main - INFO - Application started and logging configured.
2024-12-01 15:14:43,826 - code.main - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x10559d670>
2024-12-01 15:14:43,826 - code.main - INFO - Starting processing for system: PRE
2024-12-01 15:14:43,826 - code.main - INFO - Starting local material processing.
2024-12-01 15:14:43,826 - code.main - INFO - Creating dataframes.
2024-12-01 15:14:43,826 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:14:43,826 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:14:43,826 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:14:43,826 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:14:43,827 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:14:45,626 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:14:45,626 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:14:45,626 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:14:45,626 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:14:45,626 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:14:45,864 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:14:45,865 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:14:45,865 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:14:45,865 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:14:45,865 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:14:45,957 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:14:45,957 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:14:45,957 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:14:45,957 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:14:45,958 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:14:46,027 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:14:46,027 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:14:46,027 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:14:46,027 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:14:46,027 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:14:46,101 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:14:46,101 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:14:46,101 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:14:46,101 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:14:46,101 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:14:46,147 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:14:46,148 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:14:46,148 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:14:46,148 - code.main - INFO - Preparing general material data.
2024-12-01 15:14:46,148 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:14:46,186 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:14:46,361 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:14:46,385 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:14:46,410 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:14:46,410 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:14:46,410 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:14:46,629 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:14:46,629 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:14:46,629 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:14:46,695 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:14:46,695 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:14:46,695 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:14:46,717 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:14:46,717 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:14:46,717 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:14:46,731 - code.main - INFO - Selected 3 required columns
2024-12-01 15:14:46,738 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:14:46,738 - code.main - INFO - Preparing company codes data.
2024-12-01 15:14:46,738 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:14:46,757 - code.main - INFO - Selected 3 required columns
2024-12-01 15:14:46,757 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:14:46,757 - code.main - INFO - Integrating prepared data.
2024-12-01 15:14:46,757 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:14:46,757 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:14:46,757 - code.main - INFO - Starting prefixing columns
2024-12-01 15:14:46,757 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:14:46,816 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:14:46,816 - code.main - INFO - Starting prefixing columns
2024-12-01 15:14:46,816 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:14:46,836 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:14:46,836 - code.main - INFO - Starting prefixing columns
2024-12-01 15:14:46,836 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:14:46,863 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:14:46,863 - code.main - INFO - Starting prefixing columns
2024-12-01 15:14:46,863 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:14:46,877 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:14:46,877 - code.main - INFO - Starting prefixing columns
2024-12-01 15:14:46,877 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:14:46,894 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:14:46,894 - code.main - INFO - Starting prefixing columns
2024-12-01 15:14:46,894 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:14:46,906 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:14:46,906 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:14:46,915 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:14:46,947 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:14:46,947 - code.main - INFO - Joining result with T001W
2024-12-01 15:14:46,980 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:14:46,980 - code.main - INFO - Joining result with MBEW
2024-12-01 15:14:47,028 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:14:47,028 - code.main - INFO - Joining result with T001K
2024-12-01 15:14:47,055 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:14:47,055 - code.main - INFO - Joining result with T001
2024-12-01 15:14:47,088 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:14:47,088 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:14:47,105 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:14:47,105 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:14:47,106 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:14:47,228 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:14:47,228 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:14:55,808 - code.main - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 15:14:55,809 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:14:55,809 - code.main - INFO - Post-processing local material.
2024-12-01 15:14:55,809 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:14:55,940 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:14:55,973 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:14:55,973 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:14:55,973 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:14:55,973 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:14:55,995 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:14:56,011 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:14:56,012 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:14:56,012 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:14:56,012 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:14:56,048 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:14:59,075 - code.main - INFO - Initial row count before dropping duplicates: 61
2024-12-01 15:15:00,140 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:15:00,153 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:15:00,153 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:15:00,153 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:15:00,153 - code.main - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 15:15:00,153 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:15:04,914 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 15:15:04,915 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:15:04,915 - code.main - INFO - Local Material processing complete for system: PRE
2024-12-01 15:15:04,915 - code.main - INFO - Starting process order processing.
2024-12-01 15:15:04,915 - code.main - INFO - Loading required dataframes.
2024-12-01 15:15:04,915 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:15:04,915 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:15:04,915 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:15:04,915 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:15:04,915 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:15:05,184 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:15:05,185 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:15:05,185 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:15:05,185 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:15:05,185 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:05,222 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:15:05,222 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:15:05,222 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:15:05,222 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:15:05,222 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:05,244 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:15:05,244 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:15:05,244 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:15:05,244 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:15:05,244 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:05,267 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:15:05,267 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:15:05,267 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:15:05,267 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:15:05,267 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:15:05,276 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:15:05,329 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:15:05,329 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:15:05,411 - code.main - INFO - Created 'start_date' column
2024-12-01 15:15:05,411 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:15:05,433 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:15:05,435 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:15:05,435 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:15:05,435 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:15:05,436 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:15:05,451 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:15:05,453 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:15:05,453 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:15:05,453 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:15:05,466 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:15:05,467 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:15:05,467 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:15:05,467 - code.main - INFO - Fetching the global material column.
2024-12-01 15:15:05,467 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:15:05,469 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:15:05,495 - code.main - INFO - Filtering completed
2024-12-01 15:15:05,503 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:15:05,505 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:15:05,506 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:15:05,506 - code.main - INFO - Integrating prepared data.
2024-12-01 15:15:05,507 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:15:05,507 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:05,507 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:15:05,527 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:05,527 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:05,527 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:15:05,538 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:05,538 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:05,538 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:15:05,548 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:05,548 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:05,548 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:15:05,555 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:05,556 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:15:05,556 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:15:05,557 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:15:05,557 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:15:05,571 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:15:05,579 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:15:05,588 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:15:05,601 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:15:05,612 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:15:05,612 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:15:05,806 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:15:05,806 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:15:05,806 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:15:05,806 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:15:05,806 - code.main - INFO - Post-processing process order.
2024-12-01 15:15:05,806 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:15:05,806 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:15:05,806 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:15:05,806 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:15:05,826 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:15:05,846 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:15:05,846 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:15:05,893 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:15:05,924 - code.main - INFO - On-time flag is created.
2024-12-01 15:15:05,939 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:15:05,990 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:15:06,009 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:15:06,085 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:15:06,086 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:15:06,086 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:15:06,087 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:15:06,087 - code.main - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:15:06,087 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:15:10,701 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 15:15:10,701 - code.main - INFO - status of validate and write: True
2024-12-01 15:15:10,702 - code.main - INFO - Process Order processing complete for system: PRE
2024-12-01 15:15:10,702 - code.main - INFO - Starting processing for system: PRD
2024-12-01 15:15:10,702 - code.main - INFO - Starting local material processing.
2024-12-01 15:15:10,702 - code.main - INFO - Creating dataframes.
2024-12-01 15:15:10,702 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:15:10,702 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:15:10,702 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:15:10,702 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:15:10,702 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:10,973 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:15:10,973 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:15:10,973 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:15:10,973 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:15:10,973 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:15:11,027 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:15:11,028 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:15:11,028 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:15:11,028 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:15:11,028 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:11,048 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:15:11,048 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:15:11,049 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:15:11,049 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:15:11,049 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:11,063 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:15:11,063 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:15:11,063 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:15:11,063 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:15:11,063 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:11,101 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:15:11,101 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:15:11,101 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:15:11,101 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:15:11,101 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:11,119 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:15:11,119 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:15:11,119 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:15:11,119 - code.main - INFO - Preparing general material data.
2024-12-01 15:15:11,119 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:15:11,126 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:15:11,190 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:15:11,195 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:15:11,201 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:15:11,201 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:15:11,201 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:15:11,270 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:15:11,271 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:15:11,271 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:15:11,287 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:15:11,288 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:15:11,288 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:15:11,297 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:15:11,297 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:15:11,297 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:15:11,304 - code.main - INFO - Selected 3 required columns
2024-12-01 15:15:11,308 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:15:11,308 - code.main - INFO - Preparing company codes data.
2024-12-01 15:15:11,308 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:15:11,315 - code.main - INFO - Selected 3 required columns
2024-12-01 15:15:11,315 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:15:11,315 - code.main - INFO - Integrating prepared data.
2024-12-01 15:15:11,315 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:15:11,315 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:15:11,315 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:11,315 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:15:11,323 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:11,323 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:11,323 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:15:11,330 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:11,330 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:11,330 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:15:11,343 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:11,343 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:11,343 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:15:11,351 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:11,351 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:11,351 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:15:11,358 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:11,358 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:11,358 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:15:11,364 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:11,365 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:15:11,370 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:15:11,383 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:15:11,384 - code.main - INFO - Joining result with T001W
2024-12-01 15:15:11,395 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:15:11,395 - code.main - INFO - Joining result with MBEW
2024-12-01 15:15:11,404 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:15:11,404 - code.main - INFO - Joining result with T001K
2024-12-01 15:15:11,414 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:15:11,414 - code.main - INFO - Joining result with T001
2024-12-01 15:15:11,425 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:15:11,425 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:15:11,436 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:15:11,436 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:15:11,436 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:15:11,482 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:15:11,482 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:15:13,060 - code.main - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 15:15:13,060 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:15:13,060 - code.main - INFO - Post-processing local material.
2024-12-01 15:15:13,060 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:15:13,094 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:15:13,106 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:15:13,106 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:15:13,106 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:15:13,106 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:15:13,114 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:15:13,123 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:15:13,124 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:15:13,124 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:15:13,124 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:15:13,138 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:15:14,994 - code.main - INFO - Initial row count before dropping duplicates: 13
2024-12-01 15:15:15,646 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:15:15,653 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:15:15,653 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:15:15,653 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:15:15,653 - code.main - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 15:15:15,653 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:15:18,179 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 15:15:18,179 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:15:18,179 - code.main - INFO - Local Material processing complete for system: PRD
2024-12-01 15:15:18,179 - code.main - INFO - Starting process order processing.
2024-12-01 15:15:18,179 - code.main - INFO - Loading required dataframes.
2024-12-01 15:15:18,179 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:15:18,179 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:15:18,179 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:15:18,179 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:15:18,179 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:15:18,304 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:15:18,304 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:15:18,304 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:15:18,304 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:15:18,305 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:15:18,333 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:15:18,333 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:15:18,333 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:15:18,333 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:15:18,333 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:18,350 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:15:18,350 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:15:18,350 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:15:18,350 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:15:18,350 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:15:18,371 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:15:18,371 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:15:18,371 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:15:18,371 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:15:18,371 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:15:18,373 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:15:18,407 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:15:18,408 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:15:18,444 - code.main - INFO - Created 'start_date' column
2024-12-01 15:15:18,444 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:15:18,461 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:15:18,462 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:15:18,462 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:15:18,462 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:15:18,463 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:15:18,474 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:15:18,474 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:15:18,475 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:15:18,475 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:15:18,486 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:15:18,487 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:15:18,487 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:15:18,487 - code.main - INFO - Fetching the global material column.
2024-12-01 15:15:18,487 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:15:18,488 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:15:18,506 - code.main - INFO - Filtering completed
2024-12-01 15:15:18,512 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:15:18,515 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:15:18,516 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:15:18,516 - code.main - INFO - Integrating prepared data.
2024-12-01 15:15:18,516 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:15:18,516 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:18,516 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:15:18,534 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:18,535 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:18,535 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:15:18,545 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:18,545 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:18,545 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:15:18,555 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:18,556 - code.main - INFO - Starting prefixing columns
2024-12-01 15:15:18,556 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:15:18,566 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:15:18,566 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:15:18,567 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:15:18,567 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:15:18,567 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:15:18,575 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:15:18,584 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:15:18,590 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:15:18,599 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:15:18,606 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:15:18,607 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:15:18,773 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:15:18,773 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:15:18,773 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:15:18,773 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:15:18,773 - code.main - INFO - Post-processing process order.
2024-12-01 15:15:18,773 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:15:18,773 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:15:18,773 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:15:18,773 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:15:18,790 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:15:18,803 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:15:18,803 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:15:18,841 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:15:18,859 - code.main - INFO - On-time flag is created.
2024-12-01 15:15:18,874 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:15:18,889 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:15:18,902 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:15:18,930 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:15:18,931 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:15:18,931 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:15:18,932 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:15:18,932 - code.main - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:15:18,932 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:15:21,234 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 15:15:21,235 - code.main - INFO - status of validate and write: True
2024-12-01 15:15:21,235 - code.main - INFO - Process Order processing complete for system: PRD
2024-12-01 15:15:21,235 - code.main - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 15:15:21,235 - code.main - INFO - Schema matched.
2024-12-01 15:15:21,440 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:15:21,440 - code.main - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 15:15:24,951 - code.main - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 15:15:24,951 - code.main - INFO - Harmonization of Local Material data was successful.
2024-12-01 15:15:24,951 - code.main - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 15:15:24,951 - code.main - INFO - Schema matched.
2024-12-01 15:15:25,075 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:15:25,075 - code.main - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 15:15:28,784 - code.main - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 15:15:28,785 - code.main - INFO - Harmonization of Process Order data was successful.
2024-12-01 15:15:28,785 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-01 15:16:43,050 - code.main - INFO - Application started and logging configured.
2024-12-01 15:16:47,289 - code.main - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x105cc5670>
2024-12-01 15:16:47,289 - code.main - INFO - Starting processing for system: PRE
2024-12-01 15:16:47,289 - code.main - INFO - Starting local material processing.
2024-12-01 15:16:47,289 - code.main - INFO - Creating dataframes.
2024-12-01 15:16:47,289 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:16:47,289 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:16:47,289 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:16:47,289 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:16:47,290 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:16:49,102 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:16:49,102 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:16:49,102 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:16:49,102 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:16:49,102 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:16:49,332 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:16:49,333 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:16:49,333 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:16:49,333 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:16:49,333 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:16:49,452 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:16:49,452 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:16:49,452 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:16:49,452 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:16:49,452 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:16:49,524 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:16:49,524 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:16:49,524 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:16:49,524 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:16:49,524 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:16:49,592 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:16:49,592 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:16:49,592 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:16:49,592 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:16:49,593 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:16:49,626 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:16:49,626 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:16:49,626 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:16:49,626 - code.main - INFO - Preparing general material data.
2024-12-01 15:16:49,626 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:16:49,664 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:16:49,834 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:16:49,860 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:16:49,892 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:16:49,892 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:16:49,893 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:16:50,101 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:16:50,101 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:16:50,101 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:16:50,161 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:16:50,161 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:16:50,161 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:16:50,180 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:16:50,180 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:16:50,180 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:16:50,191 - code.main - INFO - Selected 3 required columns
2024-12-01 15:16:50,199 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:16:50,199 - code.main - INFO - Preparing company codes data.
2024-12-01 15:16:50,199 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:16:50,219 - code.main - INFO - Selected 3 required columns
2024-12-01 15:16:50,219 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:16:50,219 - code.main - INFO - Integrating prepared data.
2024-12-01 15:16:50,219 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:16:50,219 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:16:50,220 - code.main - INFO - Starting prefixing columns
2024-12-01 15:16:50,220 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:16:50,235 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:16:50,235 - code.main - INFO - Starting prefixing columns
2024-12-01 15:16:50,235 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:16:50,249 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:16:50,249 - code.main - INFO - Starting prefixing columns
2024-12-01 15:16:50,249 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:16:50,274 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:16:50,274 - code.main - INFO - Starting prefixing columns
2024-12-01 15:16:50,274 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:16:50,283 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:16:50,283 - code.main - INFO - Starting prefixing columns
2024-12-01 15:16:50,283 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:16:50,301 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:16:50,301 - code.main - INFO - Starting prefixing columns
2024-12-01 15:16:50,301 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:16:50,313 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:16:50,313 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:16:50,319 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:16:50,386 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:16:50,386 - code.main - INFO - Joining result with T001W
2024-12-01 15:16:50,415 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:16:50,415 - code.main - INFO - Joining result with MBEW
2024-12-01 15:16:50,456 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:16:50,456 - code.main - INFO - Joining result with T001K
2024-12-01 15:16:50,483 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:16:50,483 - code.main - INFO - Joining result with T001
2024-12-01 15:16:50,515 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:16:50,515 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:16:50,533 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:16:50,533 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:16:50,533 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:16:50,675 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:16:50,675 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:16:59,372 - code.main - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 15:16:59,372 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:16:59,372 - code.main - INFO - Post-processing local material.
2024-12-01 15:16:59,372 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:16:59,510 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:16:59,555 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:16:59,555 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:16:59,555 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:16:59,555 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:16:59,581 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:16:59,594 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:16:59,595 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:16:59,595 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:16:59,595 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:16:59,626 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:17:02,326 - code.main - INFO - Initial row count before dropping duplicates: 61
2024-12-01 15:17:03,655 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:17:03,669 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:17:03,669 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:17:03,669 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:17:03,669 - code.main - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 15:17:03,669 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:17:08,145 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 15:17:08,145 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:17:08,145 - code.main - INFO - Local Material processing complete for system: PRE
2024-12-01 15:17:08,145 - code.main - INFO - Starting process order processing.
2024-12-01 15:17:08,145 - code.main - INFO - Loading required dataframes.
2024-12-01 15:17:08,145 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:17:08,145 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:17:08,145 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:17:08,145 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:17:08,145 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:17:08,265 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:17:08,265 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:17:08,265 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:17:08,265 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:17:08,265 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:08,295 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:17:08,295 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:17:08,295 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:17:08,295 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:17:08,295 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:08,318 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:17:08,318 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:17:08,318 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:17:08,318 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:17:08,318 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:08,380 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:17:08,380 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:17:08,380 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:17:08,380 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:17:08,380 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:17:08,384 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:17:08,422 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:17:08,422 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:17:08,485 - code.main - INFO - Created 'start_date' column
2024-12-01 15:17:08,486 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:17:08,510 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:17:08,512 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:17:08,512 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:17:08,512 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:17:08,513 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:17:08,533 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:17:08,534 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:17:08,534 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:17:08,534 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:17:08,547 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:17:08,548 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:17:08,548 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:17:08,548 - code.main - INFO - Fetching the global material column.
2024-12-01 15:17:08,548 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:17:08,550 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:17:08,566 - code.main - INFO - Filtering completed
2024-12-01 15:17:08,575 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:17:08,577 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:17:08,579 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:17:08,579 - code.main - INFO - Integrating prepared data.
2024-12-01 15:17:08,579 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:17:08,579 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:08,579 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:17:08,628 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:08,628 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:08,628 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:17:08,640 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:08,640 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:08,640 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:17:08,649 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:08,649 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:08,649 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:17:08,657 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:08,660 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:17:08,660 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:17:08,660 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:17:08,661 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:17:08,672 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:17:08,681 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:17:08,696 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:17:08,710 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:17:08,716 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:17:08,716 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:17:08,921 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:17:08,921 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:17:08,921 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:17:08,921 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:17:08,921 - code.main - INFO - Post-processing process order.
2024-12-01 15:17:08,921 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:17:08,921 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:17:08,921 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:17:08,921 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:17:08,946 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:17:08,966 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:17:08,966 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:17:09,008 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:17:09,034 - code.main - INFO - On-time flag is created.
2024-12-01 15:17:09,052 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:17:09,077 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:17:09,092 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:17:09,192 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:17:09,192 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:17:09,192 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:17:09,193 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:17:09,193 - code.main - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:17:09,193 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:17:13,612 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 15:17:13,612 - code.main - INFO - status of validate and write: True
2024-12-01 15:17:13,613 - code.main - INFO - Process Order processing complete for system: PRE
2024-12-01 15:17:13,613 - code.main - INFO - Starting processing for system: PRD
2024-12-01 15:17:13,613 - code.main - INFO - Starting local material processing.
2024-12-01 15:17:13,613 - code.main - INFO - Creating dataframes.
2024-12-01 15:17:13,613 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:17:13,613 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:17:13,613 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:17:13,613 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:17:13,613 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:13,837 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:17:13,838 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:17:13,838 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:17:13,838 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:17:13,838 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:17:13,887 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:17:13,888 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:17:13,888 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:17:13,888 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:17:13,888 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:13,910 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:17:13,910 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:17:13,910 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:17:13,910 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:17:13,910 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:13,924 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:17:13,924 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:17:13,924 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:17:13,924 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:17:13,924 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:13,946 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:17:13,946 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:17:13,946 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:17:13,946 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:17:13,947 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:13,966 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:17:13,967 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:17:13,967 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:17:13,967 - code.main - INFO - Preparing general material data.
2024-12-01 15:17:13,967 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:17:13,973 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:17:14,036 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:17:14,043 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:17:14,049 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:17:14,049 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:17:14,049 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:17:14,127 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:17:14,127 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:17:14,127 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:17:14,143 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:17:14,143 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:17:14,143 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:17:14,150 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:17:14,150 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:17:14,150 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:17:14,157 - code.main - INFO - Selected 3 required columns
2024-12-01 15:17:14,161 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:17:14,161 - code.main - INFO - Preparing company codes data.
2024-12-01 15:17:14,161 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:17:14,166 - code.main - INFO - Selected 3 required columns
2024-12-01 15:17:14,166 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:17:14,166 - code.main - INFO - Integrating prepared data.
2024-12-01 15:17:14,166 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:17:14,166 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:17:14,167 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:14,167 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:17:14,174 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:14,174 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:14,174 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:17:14,180 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:14,180 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:14,180 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:17:14,195 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:14,195 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:14,195 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:17:14,209 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:14,209 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:14,209 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:17:14,217 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:14,217 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:14,217 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:17:14,226 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:14,226 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:17:14,232 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:17:14,245 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:17:14,245 - code.main - INFO - Joining result with T001W
2024-12-01 15:17:14,253 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:17:14,254 - code.main - INFO - Joining result with MBEW
2024-12-01 15:17:14,262 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:17:14,262 - code.main - INFO - Joining result with T001K
2024-12-01 15:17:14,272 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:17:14,272 - code.main - INFO - Joining result with T001
2024-12-01 15:17:14,283 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:17:14,283 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:17:14,290 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:17:14,290 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:17:14,291 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:17:14,341 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:17:14,341 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:17:16,960 - code.main - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 15:17:16,960 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:17:16,960 - code.main - INFO - Post-processing local material.
2024-12-01 15:17:16,960 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:17:17,086 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:17:17,103 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:17:17,103 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:17:17,103 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:17:17,103 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:17:17,116 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:17:17,125 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:17:17,125 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:17:17,125 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:17:17,125 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:17:17,145 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:17:18,925 - code.main - INFO - Initial row count before dropping duplicates: 13
2024-12-01 15:17:19,620 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:17:19,629 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:17:19,629 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:17:19,629 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:17:19,629 - code.main - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 15:17:19,629 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:17:22,165 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 15:17:22,165 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:17:22,165 - code.main - INFO - Local Material processing complete for system: PRD
2024-12-01 15:17:22,165 - code.main - INFO - Starting process order processing.
2024-12-01 15:17:22,165 - code.main - INFO - Loading required dataframes.
2024-12-01 15:17:22,165 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:17:22,165 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:17:22,165 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:17:22,165 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:17:22,165 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:17:22,319 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:17:22,319 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:17:22,319 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:17:22,319 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:17:22,320 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:17:22,346 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:17:22,346 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:17:22,346 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:17:22,346 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:17:22,346 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:22,370 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:17:22,370 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:17:22,370 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:17:22,370 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:17:22,370 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:17:22,397 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:17:22,398 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:17:22,398 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:17:22,398 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:17:22,398 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:17:22,400 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:17:22,440 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:17:22,441 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:17:22,483 - code.main - INFO - Created 'start_date' column
2024-12-01 15:17:22,483 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:17:22,504 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:17:22,504 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:17:22,505 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:17:22,505 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:17:22,505 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:17:22,518 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:17:22,518 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:17:22,518 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:17:22,518 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:17:22,532 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:17:22,532 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:17:22,532 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:17:22,532 - code.main - INFO - Fetching the global material column.
2024-12-01 15:17:22,532 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:17:22,533 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:17:22,556 - code.main - INFO - Filtering completed
2024-12-01 15:17:22,565 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:17:22,568 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:17:22,568 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:17:22,568 - code.main - INFO - Integrating prepared data.
2024-12-01 15:17:22,568 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:17:22,568 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:22,568 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:17:22,587 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:22,587 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:22,587 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:17:22,595 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:22,595 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:22,595 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:17:22,603 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:22,603 - code.main - INFO - Starting prefixing columns
2024-12-01 15:17:22,603 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:17:22,610 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:17:22,610 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:17:22,610 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:17:22,611 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:17:22,611 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:17:22,620 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:17:22,627 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:17:22,634 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:17:22,644 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:17:22,652 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:17:22,652 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:17:22,841 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:17:22,841 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:17:22,841 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:17:22,841 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:17:22,841 - code.main - INFO - Post-processing process order.
2024-12-01 15:17:22,841 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:17:22,841 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:17:22,841 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:17:22,841 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:17:22,858 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:17:22,872 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:17:22,872 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:17:22,905 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:17:22,925 - code.main - INFO - On-time flag is created.
2024-12-01 15:17:22,946 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:17:22,966 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:17:22,981 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:17:23,010 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:17:23,010 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:17:23,010 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:17:23,011 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:17:23,011 - code.main - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:17:23,011 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:17:24,704 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 15:17:24,704 - code.main - INFO - status of validate and write: True
2024-12-01 15:17:24,704 - code.main - INFO - Process Order processing complete for system: PRD
2024-12-01 15:17:24,704 - code.main - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 15:17:24,704 - code.main - INFO - Schema matched.
2024-12-01 15:17:24,945 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:17:24,945 - code.main - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 15:17:28,929 - code.main - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 15:17:28,930 - code.main - INFO - Harmonization of Local Material data was successful.
2024-12-01 15:17:28,930 - code.main - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 15:17:28,930 - code.main - INFO - Schema matched.
2024-12-01 15:17:29,073 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:17:29,073 - code.main - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 15:17:32,253 - code.main - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 15:17:32,253 - code.main - INFO - Harmonization of Process Order data was successful.
2024-12-01 15:17:32,253 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-01 15:26:48,824 - code.main - INFO - Application started and logging configured.
2024-12-01 15:26:52,928 - code.main - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x103d04670>
2024-12-01 15:26:52,928 - code.main - INFO - Starting processing for system: PRE
2024-12-01 15:26:52,928 - code.main - INFO - Starting local material processing.
2024-12-01 15:26:52,928 - code.main - INFO - Creating dataframes.
2024-12-01 15:26:52,928 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:26:52,928 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:26:52,928 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:26:52,928 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:26:52,928 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:26:54,725 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:26:54,725 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:26:54,725 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:26:54,725 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:26:54,725 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:26:54,958 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:26:54,958 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:26:54,958 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:26:54,958 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:26:54,958 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:26:55,071 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:26:55,071 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:26:55,071 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:26:55,071 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:26:55,071 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:26:55,146 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:26:55,146 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:26:55,146 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:26:55,146 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:26:55,146 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:26:55,219 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:26:55,219 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:26:55,219 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:26:55,219 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:26:55,219 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:26:55,263 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:26:55,263 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:26:55,263 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:26:55,263 - code.main - INFO - Preparing general material data.
2024-12-01 15:26:55,263 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:26:55,301 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:26:55,467 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:26:55,494 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:26:55,520 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:26:55,520 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:26:55,520 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:26:55,736 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:26:55,736 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:26:55,736 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:26:55,800 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:26:55,800 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:26:55,800 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:26:55,821 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:26:55,821 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:26:55,821 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:26:55,835 - code.main - INFO - Selected 3 required columns
2024-12-01 15:26:55,844 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:26:55,844 - code.main - INFO - Preparing company codes data.
2024-12-01 15:26:55,844 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:26:55,863 - code.main - INFO - Selected 3 required columns
2024-12-01 15:26:55,863 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:26:55,864 - code.main - INFO - Integrating prepared data.
2024-12-01 15:26:55,864 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:26:55,864 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:26:55,864 - code.main - INFO - Starting prefixing columns
2024-12-01 15:26:55,864 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:26:55,879 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:26:55,879 - code.main - INFO - Starting prefixing columns
2024-12-01 15:26:55,879 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:26:55,893 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:26:55,893 - code.main - INFO - Starting prefixing columns
2024-12-01 15:26:55,893 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:26:55,918 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:26:55,918 - code.main - INFO - Starting prefixing columns
2024-12-01 15:26:55,918 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:26:55,932 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:26:55,932 - code.main - INFO - Starting prefixing columns
2024-12-01 15:26:55,932 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:26:55,948 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:26:55,948 - code.main - INFO - Starting prefixing columns
2024-12-01 15:26:55,948 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:26:55,963 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:26:55,963 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:26:55,971 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:26:56,023 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:26:56,023 - code.main - INFO - Joining result with T001W
2024-12-01 15:26:56,072 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:26:56,072 - code.main - INFO - Joining result with MBEW
2024-12-01 15:26:56,119 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:26:56,119 - code.main - INFO - Joining result with T001K
2024-12-01 15:26:56,144 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:26:56,144 - code.main - INFO - Joining result with T001
2024-12-01 15:26:56,170 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:26:56,170 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:26:56,190 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:26:56,190 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:26:56,190 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:26:56,310 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:26:56,310 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:27:04,851 - code.main - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 15:27:04,851 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:27:04,851 - code.main - INFO - Post-processing local material.
2024-12-01 15:27:04,851 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:27:05,006 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:27:05,041 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:27:05,041 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:27:05,041 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:27:05,041 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:27:05,071 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:27:05,108 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:27:05,108 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:27:05,108 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:27:05,108 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:27:05,148 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:27:07,859 - code.main - INFO - Initial row count before dropping duplicates: 61
2024-12-01 15:27:09,126 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:27:09,137 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:27:09,137 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:27:09,137 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:27:09,137 - code.main - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 15:27:09,137 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:27:13,882 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 15:27:13,882 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:27:13,882 - code.main - INFO - Local Material processing complete for system: PRE
2024-12-01 15:27:13,882 - code.main - INFO - Starting process order processing.
2024-12-01 15:27:13,882 - code.main - INFO - Loading required dataframes.
2024-12-01 15:27:13,882 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:27:13,882 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:27:13,882 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:27:13,882 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:27:13,882 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:27:14,004 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:27:14,004 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:27:14,004 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:27:14,004 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:27:14,004 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:14,033 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:27:14,033 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:27:14,033 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:27:14,033 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:27:14,033 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:14,056 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:27:14,056 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:27:14,056 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:27:14,056 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:27:14,056 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:14,079 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:27:14,079 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:27:14,079 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:27:14,079 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:27:14,079 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:27:14,082 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:27:14,120 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:27:14,120 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:27:14,184 - code.main - INFO - Created 'start_date' column
2024-12-01 15:27:14,184 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:27:14,205 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:27:14,207 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:27:14,207 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:27:14,207 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:27:14,209 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:27:14,223 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:27:14,225 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:27:14,225 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:27:14,225 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:27:14,237 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:27:14,239 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:27:14,239 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:27:14,239 - code.main - INFO - Fetching the global material column.
2024-12-01 15:27:14,239 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:27:14,241 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:27:14,261 - code.main - INFO - Filtering completed
2024-12-01 15:27:14,271 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:27:14,275 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:27:14,276 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:27:14,276 - code.main - INFO - Integrating prepared data.
2024-12-01 15:27:14,276 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:27:14,276 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:14,276 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:27:14,300 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:14,300 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:14,300 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:27:14,311 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:14,311 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:14,311 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:27:14,322 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:14,322 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:14,322 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:27:14,334 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:14,334 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:27:14,334 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:27:14,335 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:27:14,335 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:27:14,344 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:27:14,353 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:27:14,365 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:27:14,381 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:27:14,388 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:27:14,388 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:27:14,596 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:27:14,596 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:27:14,596 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:27:14,596 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:27:14,596 - code.main - INFO - Post-processing process order.
2024-12-01 15:27:14,596 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:27:14,596 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:27:14,596 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:27:14,596 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:27:14,621 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:27:14,636 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:27:14,636 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:27:14,676 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:27:14,701 - code.main - INFO - On-time flag is created.
2024-12-01 15:27:14,722 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:27:14,746 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:27:14,759 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:27:14,831 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:27:14,831 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:27:14,831 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:27:14,832 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:27:14,832 - code.main - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:27:14,832 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:27:18,927 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 15:27:18,927 - code.main - INFO - status of validate and write: True
2024-12-01 15:27:18,927 - code.main - INFO - Process Order processing complete for system: PRE
2024-12-01 15:27:18,927 - code.main - INFO - Starting processing for system: PRD
2024-12-01 15:27:18,927 - code.main - INFO - Starting local material processing.
2024-12-01 15:27:18,927 - code.main - INFO - Creating dataframes.
2024-12-01 15:27:18,927 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:27:18,927 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:27:18,927 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:27:18,927 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:27:18,927 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:19,174 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:27:19,174 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:27:19,174 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:27:19,174 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:27:19,174 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:27:19,225 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:27:19,225 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:27:19,225 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:27:19,225 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:27:19,225 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:19,251 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:27:19,251 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:27:19,251 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:27:19,251 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:27:19,251 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:19,265 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:27:19,265 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:27:19,265 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:27:19,265 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:27:19,265 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:19,306 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:27:19,306 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:27:19,306 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:27:19,306 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:27:19,306 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:19,327 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:27:19,327 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:27:19,327 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:27:19,327 - code.main - INFO - Preparing general material data.
2024-12-01 15:27:19,327 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:27:19,334 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:27:19,400 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:27:19,405 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:27:19,411 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:27:19,411 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:27:19,411 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:27:19,478 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:27:19,478 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:27:19,478 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:27:19,492 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:27:19,492 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:27:19,492 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:27:19,498 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:27:19,499 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:27:19,499 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:27:19,504 - code.main - INFO - Selected 3 required columns
2024-12-01 15:27:19,506 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:27:19,506 - code.main - INFO - Preparing company codes data.
2024-12-01 15:27:19,506 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:27:19,515 - code.main - INFO - Selected 3 required columns
2024-12-01 15:27:19,515 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:27:19,515 - code.main - INFO - Integrating prepared data.
2024-12-01 15:27:19,515 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:27:19,515 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:27:19,515 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:19,515 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:27:19,522 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:19,522 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:19,522 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:27:19,529 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:19,530 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:19,530 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:27:19,542 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:19,542 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:19,542 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:27:19,551 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:19,551 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:19,551 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:27:19,557 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:19,557 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:19,557 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:27:19,565 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:19,565 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:27:19,573 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:27:19,586 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:27:19,586 - code.main - INFO - Joining result with T001W
2024-12-01 15:27:19,596 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:27:19,596 - code.main - INFO - Joining result with MBEW
2024-12-01 15:27:19,607 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:27:19,607 - code.main - INFO - Joining result with T001K
2024-12-01 15:27:19,618 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:27:19,618 - code.main - INFO - Joining result with T001
2024-12-01 15:27:19,648 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:27:19,648 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:27:19,656 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:27:19,656 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:27:19,656 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:27:19,699 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:27:19,700 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:27:22,060 - code.main - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 15:27:22,060 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:27:22,060 - code.main - INFO - Post-processing local material.
2024-12-01 15:27:22,060 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:27:22,220 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:27:22,244 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:27:22,244 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:27:22,244 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:27:22,244 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:27:22,258 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:27:22,267 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:27:22,267 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:27:22,267 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:27:22,267 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:27:22,292 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:27:23,131 - code.main - INFO - Initial row count before dropping duplicates: 13
2024-12-01 15:27:23,611 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:27:23,612 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:27:23,612 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:27:23,612 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:27:23,612 - code.main - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 15:27:23,612 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:27:26,238 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 15:27:26,238 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:27:26,238 - code.main - INFO - Local Material processing complete for system: PRD
2024-12-01 15:27:26,238 - code.main - INFO - Starting process order processing.
2024-12-01 15:27:26,238 - code.main - INFO - Loading required dataframes.
2024-12-01 15:27:26,238 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:27:26,238 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:27:26,238 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:27:26,238 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:27:26,238 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:27:26,385 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:27:26,385 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:27:26,385 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:27:26,385 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:27:26,385 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:27:26,412 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:27:26,412 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:27:26,412 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:27:26,412 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:27:26,412 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:26,433 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:27:26,433 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:27:26,433 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:27:26,433 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:27:26,433 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:27:26,455 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:27:26,456 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:27:26,456 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:27:26,456 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:27:26,456 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:27:26,457 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:27:26,491 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:27:26,491 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:27:26,524 - code.main - INFO - Created 'start_date' column
2024-12-01 15:27:26,524 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:27:26,539 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:27:26,540 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:27:26,540 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:27:26,540 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:27:26,541 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:27:26,550 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:27:26,550 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:27:26,550 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:27:26,550 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:27:26,562 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:27:26,563 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:27:26,563 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:27:26,563 - code.main - INFO - Fetching the global material column.
2024-12-01 15:27:26,563 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:27:26,564 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:27:26,585 - code.main - INFO - Filtering completed
2024-12-01 15:27:26,593 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:27:26,600 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:27:26,601 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:27:26,601 - code.main - INFO - Integrating prepared data.
2024-12-01 15:27:26,601 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:27:26,601 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:26,601 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:27:26,626 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:26,626 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:26,626 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:27:26,636 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:26,636 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:26,636 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:27:26,647 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:26,647 - code.main - INFO - Starting prefixing columns
2024-12-01 15:27:26,647 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:27:26,657 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:27:26,657 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:27:26,658 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:27:26,658 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:27:26,658 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:27:26,666 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:27:26,675 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:27:26,687 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:27:26,701 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:27:26,708 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:27:26,708 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:27:26,868 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:27:26,868 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:27:26,868 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:27:26,868 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:27:26,868 - code.main - INFO - Post-processing process order.
2024-12-01 15:27:26,868 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:27:26,868 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:27:26,868 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:27:26,868 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:27:26,884 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:27:26,899 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:27:26,899 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:27:26,941 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:27:26,960 - code.main - INFO - On-time flag is created.
2024-12-01 15:27:26,979 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:27:26,998 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:27:27,015 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:27:27,053 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:27:27,053 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:27:27,053 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:27:27,054 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:27:27,054 - code.main - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:27:27,054 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:27:29,274 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 15:27:29,275 - code.main - INFO - status of validate and write: True
2024-12-01 15:27:29,275 - code.main - INFO - Process Order processing complete for system: PRD
2024-12-01 15:27:29,275 - code.main - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 15:27:29,275 - code.main - INFO - Schema matched.
2024-12-01 15:27:29,496 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:27:29,496 - code.main - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 15:27:34,104 - code.main - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 15:27:34,104 - code.main - INFO - Harmonization of Local Material data was successful.
2024-12-01 15:27:34,104 - code.main - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 15:27:34,104 - code.main - INFO - Schema matched.
2024-12-01 15:27:34,272 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:27:34,272 - code.main - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 15:27:37,510 - code.main - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 15:27:37,510 - code.main - INFO - Harmonization of Process Order data was successful.
2024-12-01 15:27:37,510 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-01 15:30:10,752 - code.main - INFO - Application started and logging configured.
2024-12-01 15:30:15,021 - code.main - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x101ca8670>
2024-12-01 15:30:15,021 - code.main - INFO - Starting processing for system: PRE
2024-12-01 15:30:15,021 - code.main - INFO - Starting local material processing.
2024-12-01 15:30:15,021 - code.main - INFO - Creating dataframes.
2024-12-01 15:30:15,021 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:30:15,021 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:30:15,021 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:30:15,021 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:30:15,021 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:16,954 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:30:16,954 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:30:16,955 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:30:16,955 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:30:16,955 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:30:17,205 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:30:17,205 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:30:17,205 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:30:17,205 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:30:17,205 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:17,344 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:30:17,344 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:30:17,344 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:30:17,344 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:30:17,344 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:17,419 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:30:17,419 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:30:17,419 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:30:17,419 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:30:17,419 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:17,489 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:30:17,489 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:30:17,489 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:30:17,489 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:30:17,489 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:17,531 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:30:17,531 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:30:17,531 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:30:17,531 - code.main - INFO - Preparing general material data.
2024-12-01 15:30:17,531 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:30:17,573 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:30:17,767 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:30:17,794 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:30:17,824 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:30:17,824 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:30:17,824 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:30:18,057 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:30:18,057 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:30:18,057 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:30:18,127 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:30:18,127 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:30:18,127 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:30:18,149 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:30:18,149 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:30:18,149 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:30:18,164 - code.main - INFO - Selected 3 required columns
2024-12-01 15:30:18,172 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:30:18,172 - code.main - INFO - Preparing company codes data.
2024-12-01 15:30:18,173 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:30:18,192 - code.main - INFO - Selected 3 required columns
2024-12-01 15:30:18,192 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:30:18,192 - code.main - INFO - Integrating prepared data.
2024-12-01 15:30:18,192 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:30:18,192 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:30:18,192 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:18,192 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:30:18,212 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:18,212 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:18,212 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:30:18,228 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:18,228 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:18,228 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:30:18,259 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:18,259 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:18,259 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:30:18,272 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:18,272 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:18,272 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:30:18,287 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:18,287 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:18,287 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:30:18,402 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:18,402 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:30:18,414 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:30:18,466 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:30:18,466 - code.main - INFO - Joining result with T001W
2024-12-01 15:30:18,494 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:30:18,494 - code.main - INFO - Joining result with MBEW
2024-12-01 15:30:18,548 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:30:18,548 - code.main - INFO - Joining result with T001K
2024-12-01 15:30:18,582 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:30:18,582 - code.main - INFO - Joining result with T001
2024-12-01 15:30:18,604 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:30:18,604 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:30:18,623 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:30:18,623 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:30:18,623 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:30:18,752 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:30:18,752 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:30:27,555 - code.main - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 15:30:27,555 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:30:27,555 - code.main - INFO - Post-processing local material.
2024-12-01 15:30:27,555 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:30:27,742 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:30:27,787 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:30:27,787 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:30:27,787 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:30:27,787 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:30:27,809 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:30:27,826 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:30:27,826 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:30:27,826 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:30:27,826 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:30:27,867 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:30:30,362 - code.main - INFO - Initial row count before dropping duplicates: 61
2024-12-01 15:30:32,359 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:30:32,394 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:30:32,394 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:30:32,394 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:30:32,394 - code.main - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 15:30:32,394 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:30:36,761 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 15:30:36,761 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:30:36,761 - code.main - INFO - Local Material processing complete for system: PRE
2024-12-01 15:30:36,761 - code.main - INFO - Starting process order processing.
2024-12-01 15:30:36,762 - code.main - INFO - Loading required dataframes.
2024-12-01 15:30:36,762 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:30:36,762 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:30:36,762 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:30:36,762 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:30:36,762 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:30:36,890 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:30:36,890 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:30:36,890 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:30:36,890 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:30:36,890 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:36,923 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:30:36,923 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:30:36,923 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:30:36,923 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:30:36,923 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:36,944 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:30:36,944 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:30:36,944 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:30:36,944 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:30:36,944 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:36,967 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:30:36,967 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:30:36,967 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:30:36,967 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:30:36,967 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:30:36,970 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:30:37,006 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:30:37,006 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:30:37,063 - code.main - INFO - Created 'start_date' column
2024-12-01 15:30:37,063 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:30:37,086 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:30:37,088 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:30:37,088 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:30:37,088 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:30:37,089 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:30:37,101 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:30:37,103 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:30:37,103 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:30:37,103 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:30:37,114 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:30:37,115 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:30:37,115 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:30:37,115 - code.main - INFO - Fetching the global material column.
2024-12-01 15:30:37,115 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:30:37,117 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:30:37,135 - code.main - INFO - Filtering completed
2024-12-01 15:30:37,146 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:30:37,149 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:30:37,149 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:30:37,149 - code.main - INFO - Integrating prepared data.
2024-12-01 15:30:37,149 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:30:37,149 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:37,149 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:30:37,171 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:37,171 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:37,171 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:30:37,180 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:37,180 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:37,180 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:30:37,188 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:37,188 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:37,188 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:30:37,196 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:37,197 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:30:37,197 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:30:37,197 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:30:37,197 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:30:37,207 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:30:37,237 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:30:37,255 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:30:37,270 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:30:37,280 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:30:37,280 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:30:37,461 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:30:37,461 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:30:37,461 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:30:37,461 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:30:37,461 - code.main - INFO - Post-processing process order.
2024-12-01 15:30:37,461 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:30:37,461 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:30:37,461 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:30:37,461 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:30:37,481 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:30:37,500 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:30:37,500 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:30:37,542 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:30:37,565 - code.main - INFO - On-time flag is created.
2024-12-01 15:30:37,582 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:30:37,606 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:30:37,620 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:30:38,142 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:30:38,142 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:30:38,142 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:30:38,168 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:30:38,168 - code.main - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:30:38,168 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:30:42,531 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 15:30:42,532 - code.main - INFO - status of validate and write: True
2024-12-01 15:30:42,532 - code.main - INFO - Process Order processing complete for system: PRE
2024-12-01 15:30:42,532 - code.main - INFO - Starting processing for system: PRD
2024-12-01 15:30:42,532 - code.main - INFO - Starting local material processing.
2024-12-01 15:30:42,532 - code.main - INFO - Creating dataframes.
2024-12-01 15:30:42,532 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:30:42,532 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:30:42,532 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:30:42,532 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:30:42,532 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:42,670 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:30:42,670 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:30:42,670 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:30:42,670 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:30:42,670 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:30:42,721 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:30:42,721 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:30:42,721 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:30:42,721 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:30:42,721 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:42,745 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:30:42,745 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:30:42,745 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:30:42,745 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:30:42,745 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:42,759 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:30:42,760 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:30:42,760 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:30:42,760 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:30:42,760 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:42,780 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:30:42,781 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:30:42,781 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:30:42,781 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:30:42,781 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:42,813 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:30:42,814 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:30:42,814 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:30:42,814 - code.main - INFO - Preparing general material data.
2024-12-01 15:30:42,814 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:30:42,816 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:30:42,869 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:30:42,875 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:30:42,882 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:30:42,882 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:30:42,882 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:30:42,953 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:30:42,953 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:30:42,953 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:30:42,971 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:30:42,971 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:30:42,971 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:30:42,978 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:30:42,978 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:30:42,978 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:30:42,983 - code.main - INFO - Selected 3 required columns
2024-12-01 15:30:42,986 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:30:42,986 - code.main - INFO - Preparing company codes data.
2024-12-01 15:30:42,986 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:30:42,994 - code.main - INFO - Selected 3 required columns
2024-12-01 15:30:42,994 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:30:42,994 - code.main - INFO - Integrating prepared data.
2024-12-01 15:30:42,994 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:30:42,994 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:30:42,994 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:42,994 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:30:43,001 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:43,002 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:43,002 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:30:43,010 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:43,011 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:43,011 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:30:43,025 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:43,025 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:43,025 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:30:43,035 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:43,035 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:43,035 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:30:43,042 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:43,042 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:43,042 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:30:43,049 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:43,049 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:30:43,054 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:30:43,064 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:30:43,064 - code.main - INFO - Joining result with T001W
2024-12-01 15:30:43,072 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:30:43,072 - code.main - INFO - Joining result with MBEW
2024-12-01 15:30:43,083 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:30:43,084 - code.main - INFO - Joining result with T001K
2024-12-01 15:30:43,094 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:30:43,094 - code.main - INFO - Joining result with T001
2024-12-01 15:30:43,105 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:30:43,105 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:30:43,112 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:30:43,112 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:30:43,112 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:30:43,188 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:30:43,189 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:30:45,537 - code.main - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 15:30:45,537 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:30:45,537 - code.main - INFO - Post-processing local material.
2024-12-01 15:30:45,537 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:30:45,658 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:30:45,675 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:30:45,675 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:30:45,675 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:30:45,675 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:30:45,686 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:30:45,694 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:30:45,694 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:30:45,694 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:30:45,694 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:30:45,715 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:30:47,542 - code.main - INFO - Initial row count before dropping duplicates: 13
2024-12-01 15:30:48,219 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:30:48,226 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:30:48,227 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:30:48,227 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:30:48,227 - code.main - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 15:30:48,227 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:30:50,805 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 15:30:50,805 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:30:50,805 - code.main - INFO - Local Material processing complete for system: PRD
2024-12-01 15:30:50,805 - code.main - INFO - Starting process order processing.
2024-12-01 15:30:50,805 - code.main - INFO - Loading required dataframes.
2024-12-01 15:30:50,805 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:30:50,805 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:30:50,805 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:30:50,805 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:30:50,805 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:30:50,931 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:30:50,931 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:30:50,931 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:30:50,931 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:30:50,931 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:30:50,958 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:30:50,958 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:30:50,958 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:30:50,958 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:30:50,958 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:50,978 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:30:50,978 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:30:50,978 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:30:50,978 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:30:50,978 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:30:51,000 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:30:51,000 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:30:51,000 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:30:51,000 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:30:51,000 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:30:51,002 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:30:51,035 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:30:51,035 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:30:51,068 - code.main - INFO - Created 'start_date' column
2024-12-01 15:30:51,069 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:30:51,088 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:30:51,088 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:30:51,088 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:30:51,089 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:30:51,089 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:30:51,098 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:30:51,099 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:30:51,099 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:30:51,099 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:30:51,108 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:30:51,109 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:30:51,109 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:30:51,109 - code.main - INFO - Fetching the global material column.
2024-12-01 15:30:51,109 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:30:51,110 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:30:51,129 - code.main - INFO - Filtering completed
2024-12-01 15:30:51,135 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:30:51,137 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:30:51,138 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:30:51,138 - code.main - INFO - Integrating prepared data.
2024-12-01 15:30:51,138 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:30:51,138 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:51,138 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:30:51,157 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:51,157 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:51,157 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:30:51,166 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:51,166 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:51,166 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:30:51,177 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:51,177 - code.main - INFO - Starting prefixing columns
2024-12-01 15:30:51,177 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:30:51,184 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:30:51,184 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:30:51,184 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:30:51,185 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:30:51,185 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:30:51,193 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:30:51,200 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:30:51,207 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:30:51,217 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:30:51,221 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:30:51,221 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:30:51,396 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:30:51,396 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:30:51,396 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:30:51,396 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:30:51,396 - code.main - INFO - Post-processing process order.
2024-12-01 15:30:51,396 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:30:51,396 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:30:51,396 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:30:51,396 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:30:51,414 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:30:51,427 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:30:51,427 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:30:51,461 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:30:51,479 - code.main - INFO - On-time flag is created.
2024-12-01 15:30:51,493 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:30:51,510 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:30:51,526 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:30:51,590 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:30:51,590 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:30:51,590 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:30:51,591 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:30:51,591 - code.main - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:30:51,591 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:30:53,012 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 15:30:53,012 - code.main - INFO - status of validate and write: True
2024-12-01 15:30:53,012 - code.main - INFO - Process Order processing complete for system: PRD
2024-12-01 15:30:53,012 - code.main - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 15:30:53,012 - code.main - INFO - Schema matched.
2024-12-01 15:30:53,284 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:30:53,284 - code.main - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 15:30:57,386 - code.main - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 15:30:57,386 - code.main - INFO - Harmonization of Local Material data was successful.
2024-12-01 15:30:57,386 - code.main - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 15:30:57,386 - code.main - INFO - Schema matched.
2024-12-01 15:30:57,512 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:30:57,512 - code.main - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 15:31:00,132 - code.main - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 15:31:00,132 - code.main - INFO - Harmonization of Process Order data was successful.
2024-12-01 15:31:00,132 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-01 15:33:06,020 - code.main - INFO - Application started and logging configured.
2024-12-01 15:33:10,255 - code.main - INFO - Spark session initialized: <pyspark.sql.session.SparkSession object at 0x103de4670>
2024-12-01 15:33:10,255 - code.main - INFO - Starting processing for system: PRE
2024-12-01 15:33:10,255 - code.main - INFO - Starting local material processing.
2024-12-01 15:33:10,255 - code.main - INFO - Creating dataframes.
2024-12-01 15:33:10,255 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:33:10,255 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:33:10,255 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:33:10,255 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:33:10,255 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:12,060 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:33:12,060 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:33:12,060 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:33:12,060 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:33:12,060 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZPSPER', IntegerType(), True), StructField('ZZPSREV', StringType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZPLT_ICM', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:33:12,274 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:33:12,274 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:33:12,274 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:33:12,274 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:33:12,274 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:12,398 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:33:12,398 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:33:12,398 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:33:12,398 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:33:12,399 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('ZGOLIVEDATE', DateType(), True), StructField('ZVKORG', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:12,470 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:33:12,470 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:33:12,470 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:33:12,470 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:33:12,470 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:12,535 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:33:12,535 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:33:12,535 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:33:12,535 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:33:12,536 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('XVATDATE', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:12,579 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:33:12,579 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:33:12,579 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:33:12,579 - code.main - INFO - Preparing general material data.
2024-12-01 15:33:12,579 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:33:12,616 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:33:12,776 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:33:12,804 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:33:12,834 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:33:12,834 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:33:12,834 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:33:13,034 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:33:13,034 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:33:13,034 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:33:13,084 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:33:13,084 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:33:13,084 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:33:13,104 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:33:13,104 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:33:13,104 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:33:13,126 - code.main - INFO - Selected 3 required columns
2024-12-01 15:33:13,132 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:33:13,132 - code.main - INFO - Preparing company codes data.
2024-12-01 15:33:13,132 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:33:13,152 - code.main - INFO - Selected 3 required columns
2024-12-01 15:33:13,152 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:33:13,152 - code.main - INFO - Integrating prepared data.
2024-12-01 15:33:13,152 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:33:13,152 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:33:13,152 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:13,152 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:33:13,170 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:13,171 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:13,171 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:33:13,186 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:13,187 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:13,187 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:33:13,217 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:13,217 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:13,217 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:33:13,231 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:13,231 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:13,231 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:33:13,267 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:13,268 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:13,268 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:33:13,301 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:13,301 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:33:13,306 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:33:13,331 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:33:13,331 - code.main - INFO - Joining result with T001W
2024-12-01 15:33:13,361 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:33:13,361 - code.main - INFO - Joining result with MBEW
2024-12-01 15:33:13,396 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:33:13,396 - code.main - INFO - Joining result with T001K
2024-12-01 15:33:13,424 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:33:13,424 - code.main - INFO - Joining result with T001
2024-12-01 15:33:13,453 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:33:13,453 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:33:13,480 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:33:13,480 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:33:13,480 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:33:13,618 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:33:13,618 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:33:22,256 - code.main - INFO - Number of rows in the final integrated DataFrame: 61
2024-12-01 15:33:22,256 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:33:22,256 - code.main - INFO - Post-processing local material.
2024-12-01 15:33:22,256 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:33:22,451 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:33:22,493 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:33:22,493 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:33:22,493 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:33:22,493 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:33:22,517 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:33:22,535 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:33:22,536 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:33:22,536 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:33:22,536 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:33:22,570 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:33:26,084 - code.main - INFO - Initial row count before dropping duplicates: 61
2024-12-01 15:33:27,045 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:33:27,059 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:33:27,059 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:33:27,059 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:33:27,059 - code.main - INFO - Writing the data for system: PRE and table_name: LOCAL_MATERIAL
2024-12-01 15:33:27,060 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:33:31,698 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/LOCAL_MATERIAL/
2024-12-01 15:33:31,698 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:33:31,698 - code.main - INFO - Local Material processing complete for system: PRE
2024-12-01 15:33:31,698 - code.main - INFO - Starting process order processing.
2024-12-01 15:33:31,698 - code.main - INFO - Loading required dataframes.
2024-12-01 15:33:31,698 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:33:31,698 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:33:31,698 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:33:31,698 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:33:31,698 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('ZNOPRINT', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:33:31,932 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:33:31,932 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:33:31,932 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:33:31,932 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:33:31,932 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('APRIO', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:31,971 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:33:31,971 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:33:31,971 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:33:31,971 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:33:31,971 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:31,995 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:33:31,995 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:33:31,995 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:33:31,995 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:33:31,996 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:32,020 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:33:32,020 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:33:32,020 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:33:32,020 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:33:32,020 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:33:32,029 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:33:32,081 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:33:32,081 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:33:32,143 - code.main - INFO - Created 'start_date' column
2024-12-01 15:33:32,143 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:33:32,167 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:33:32,169 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:33:32,169 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:33:32,169 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:33:32,171 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:33:32,184 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:33:32,184 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:33:32,184 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:33:32,184 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:33:32,195 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:33:32,196 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:33:32,196 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:33:32,196 - code.main - INFO - Fetching the global material column.
2024-12-01 15:33:32,196 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:33:32,197 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:33:32,224 - code.main - INFO - Filtering completed
2024-12-01 15:33:32,233 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:33:32,236 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:33:32,237 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:33:32,237 - code.main - INFO - Integrating prepared data.
2024-12-01 15:33:32,237 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:33:32,237 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:32,237 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:33:32,260 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:32,260 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:32,260 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:33:32,270 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:32,270 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:32,270 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:33:32,279 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:32,279 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:32,279 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:33:32,287 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:32,289 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:33:32,289 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:33:32,290 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:33:32,290 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:33:32,304 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:33:32,313 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:33:32,322 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:33:32,338 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:33:32,352 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:33:32,352 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:33:32,547 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:33:32,547 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:33:32,547 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:33:32,547 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:33:32,547 - code.main - INFO - Post-processing process order.
2024-12-01 15:33:32,547 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:33:32,547 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:33:32,547 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:33:32,547 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:33:32,566 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:33:32,581 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:33:32,581 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:33:32,662 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:33:32,686 - code.main - INFO - On-time flag is created.
2024-12-01 15:33:32,705 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:33:32,728 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:33:32,748 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:33:32,811 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:33:32,811 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:33:32,811 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:33:32,812 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:33:32,812 - code.main - INFO - Writing the data for system: PRE and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:33:32,812 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:33:37,334 - code.main - INFO - DataFrame successfully written to path: ./output/PRE/PROCESS_ORDER_SCHEMA/
2024-12-01 15:33:37,334 - code.main - INFO - status of validate and write: True
2024-12-01 15:33:37,334 - code.main - INFO - Process Order processing complete for system: PRE
2024-12-01 15:33:37,334 - code.main - INFO - Starting processing for system: PRD
2024-12-01 15:33:37,334 - code.main - INFO - Starting local material processing.
2024-12-01 15:33:37,334 - code.main - INFO - Creating dataframes.
2024-12-01 15:33:37,334 - code.main - INFO - Creating required dataframes for local material processing.
2024-12-01 15:33:37,334 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:33:37,334 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:33:37,334 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:33:37,334 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:37,599 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:33:37,599 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:33:37,599 - code.main - INFO - Creating DataFrame for table: MARC
2024-12-01 15:33:37,599 - code.main - INFO - Schema retrieved for table: MARC
2024-12-01 15:33:37,599 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('BWTTY', StringType(), True), StructField('XCHAR', StringType(), True), StructField('MMSTA', StringType(), True), StructField('MMSTD', DateType(), True), StructField('MAABC', StringType(), True), StructField('KZKRI', StringType(), True), StructField('EKGRP', StringType(), True), StructField('AUSME', StringType(), True), StructField('DISPR', StringType(), True), StructField('DISMM', StringType(), True), StructField('DISPO', StringType(), True), StructField('KZDIE', StringType(), True), StructField('PLIFZ', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('PERKZ', StringType(), True), StructField('AUSSS', DoubleType(), True), StructField('DISLS', StringType(), True), StructField('BESKZ', StringType(), True), StructField('SOBSL', StringType(), True), StructField('MINBE', DoubleType(), True), StructField('EISBE', DoubleType(), True), StructField('BSTMI', DoubleType(), True), StructField('BSTMA', DoubleType(), True), StructField('BSTFE', DoubleType(), True), StructField('BSTRF', DoubleType(), True), StructField('MABST', DoubleType(), True), StructField('LOSFX', DoubleType(), True), StructField('SBDKZ', StringType(), True), StructField('LAGPR', StringType(), True), StructField('ALTSL', StringType(), True), StructField('KZAUS', StringType(), True), StructField('AUSDT', DateType(), True), StructField('NFMAT', StringType(), True), StructField('KZBED', StringType(), True), StructField('MISKZ', StringType(), True), StructField('FHORI', StringType(), True), StructField('PFREI', StringType(), True), StructField('FFREI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('FEVOR', StringType(), True), StructField('BEARZ', DoubleType(), True), StructField('RUEZT', DoubleType(), True), StructField('TRANZ', DoubleType(), True), StructField('BASMG', DoubleType(), True), StructField('DZEIT', DoubleType(), True), StructField('MAXLZ', DoubleType(), True), StructField('LZEIH', StringType(), True), StructField('KZPRO', StringType(), True), StructField('GPMKZ', StringType(), True), StructField('UEETO', DoubleType(), True), StructField('UEETK', StringType(), True), StructField('UNETO', DoubleType(), True), StructField('WZEIT', DoubleType(), True), StructField('ATPKZ', StringType(), True), StructField('VZUSL', DoubleType(), True), StructField('HERBL', StringType(), True), StructField('INSMK', StringType(), True), StructField('SPROZ', DoubleType(), True), StructField('QUAZT', DoubleType(), True), StructField('SSQSS', StringType(), True), StructField('MPDAU', DoubleType(), True), StructField('KZPPV', StringType(), True), StructField('KZDKZ', StringType(), True), StructField('WSTGH', DoubleType(), True), StructField('PRFRQ', DoubleType(), True), StructField('NKMPR', DateType(), True), StructField('UMLMC', DoubleType(), True), StructField('LADGR', StringType(), True), StructField('XCHPF', StringType(), True), StructField('USEQU', StringType(), True), StructField('LGRAD', DoubleType(), True), StructField('AUFTL', StringType(), True), StructField('PLVAR', StringType(), True), StructField('OTYPE', StringType(), True), StructField('OBJID', StringType(), True), StructField('MTVFP', StringType(), True), StructField('PERIV', StringType(), True), StructField('KZKFK', StringType(), True), StructField('VRVEZ', DoubleType(), True), StructField('VBAMG', DoubleType(), True), StructField('VBEAZ', DoubleType(), True), StructField('LIZYK', StringType(), True), StructField('BWSCL', StringType(), True), StructField('KAUTB', StringType(), True), StructField('KORDB', StringType(), True), StructField('STAWN', StringType(), True), StructField('HERKL', StringType(), True), StructField('HERKR', StringType(), True), StructField('EXPME', StringType(), True), StructField('MTVER', StringType(), True), StructField('PRCTR', StringType(), True), StructField('TRAME', DoubleType(), True), StructField('MRPPP', StringType(), True), StructField('SAUFT', StringType(), True), StructField('FXHOR', StringType(), True), StructField('VRMOD', StringType(), True), StructField('VINT1', StringType(), True), StructField('VINT2', StringType(), True), StructField('VERKZ', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('PLNNR', StringType(), True), StructField('APLAL', StringType(), True), StructField('LOSGR', DoubleType(), True), StructField('SOBSK', StringType(), True), StructField('FRTME', StringType(), True), StructField('LGPRO', StringType(), True), StructField('DISGR', StringType(), True), StructField('KAUSF', DoubleType(), True), StructField('QZGTP', StringType(), True), StructField('QMATV', StringType(), True), StructField('TAKZT', DoubleType(), True), StructField('RWPRO', StringType(), True), StructField('COPAM', StringType(), True), StructField('ABCIN', StringType(), True), StructField('AWSLS', StringType(), True), StructField('SERNP', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('STDPD', StringType(), True), StructField('SFEPR', StringType(), True), StructField('XMCNG', StringType(), True), StructField('QSSYS', StringType(), True), StructField('LFRHY', StringType(), True), StructField('RDPRF', StringType(), True), StructField('VRBMT', StringType(), True), StructField('VRBWK', StringType(), True), StructField('VRBDT', DateType(), True), StructField('VRBFK', DoubleType(), True), StructField('AUTRU', StringType(), True), StructField('PREFE', StringType(), True), StructField('PRENC', StringType(), True), StructField('PRENO', StringType(), True), StructField('PREND', DateType(), True), StructField('PRENE', StringType(), True), StructField('PRENG', DateType(), True), StructField('ITARK', StringType(), True), StructField('SERVG', StringType(), True), StructField('KZKUP', StringType(), True), StructField('STRGR', StringType(), True), StructField('CUOBV', StringType(), True), StructField('LGFSB', StringType(), True), StructField('SCHGT', StringType(), True), StructField('CCFIX', StringType(), True), StructField('EPRIO', StringType(), True), StructField('QMATA', StringType(), True), StructField('RESVP', DoubleType(), True), StructField('PLNTY', StringType(), True), StructField('UOMGR', StringType(), True), StructField('UMRSL', StringType(), True), StructField('ABFAC', DoubleType(), True), StructField('SFCPF', StringType(), True), StructField('SHFLG', StringType(), True), StructField('SHZET', StringType(), True), StructField('MDACH', StringType(), True), StructField('KZECH', StringType(), True), StructField('MEGRU', StringType(), True), StructField('MFRGR', StringType(), True), StructField('VKUMC', DoubleType(), True), StructField('VKTRW', DoubleType(), True), StructField('KZAGL', StringType(), True), StructField('FVIDK', StringType(), True), StructField('FXPRU', StringType(), True), StructField('LOGGR', StringType(), True), StructField('FPRFM', StringType(), True), StructField('GLGMG', DoubleType(), True), StructField('VKGLG', DoubleType(), True), StructField('INDUS', StringType(), True), StructField('MOWNR', StringType(), True), StructField('MOGRU', StringType(), True), StructField('CASNR', StringType(), True), StructField('GPNUM', StringType(), True), StructField('STEUC', StringType(), True), StructField('FABKZ', StringType(), True), StructField('MATGR', StringType(), True), StructField('VSPVB', StringType(), True), StructField('DPLFS', StringType(), True), StructField('DPLPU', StringType(), True), StructField('DPLHO', DoubleType(), True), StructField('MINLS', DoubleType(), True), StructField('MAXLS', DoubleType(), True), StructField('FIXLS', DoubleType(), True), StructField('LTINC', DoubleType(), True), StructField('COMPL', StringType(), True), StructField('CONVT', StringType(), True), StructField('SHPRO', StringType(), True), StructField('AHDIS', StringType(), True), StructField('DIBER', StringType(), True), StructField('KZPSP', StringType(), True), StructField('OCMPF', StringType(), True), StructField('APOKZ', StringType(), True), StructField('MCRUE', StringType(), True), StructField('LFMON', StringType(), True), StructField('LFGJA', StringType(), True), StructField('EISLO', DoubleType(), True), StructField('NCOST', StringType(), True), StructField('ROTATION_DATE', StringType(), True), StructField('UCHKZ', StringType(), True), StructField('UCMAT', StringType(), True), StructField('ZZREVIEWDT', DateType(), True), StructField('ZZGATNEXT', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('ZZAPO_MRPTYPE', StringType(), True), StructField('ZZMSDS_REQ', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:33:37,653 - code.main - INFO - Successfully created DataFrame for table: MARC
2024-12-01 15:33:37,653 - code.main - INFO - Successfully created DataFrame: MARC
2024-12-01 15:33:37,653 - code.main - INFO - Creating DataFrame for table: MBEW
2024-12-01 15:33:37,653 - code.main - INFO - Schema retrieved for table: MBEW
2024-12-01 15:33:37,653 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BWTAR', StringType(), True), StructField('LVORM', StringType(), True), StructField('LBKUM', DoubleType(), True), StructField('SALK3', DoubleType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('SALKV', DoubleType(), True), StructField('VMKUM', DoubleType(), True), StructField('VMSAL', DoubleType(), True), StructField('VMVPR', StringType(), True), StructField('VMVER', DoubleType(), True), StructField('VMSTP', DoubleType(), True), StructField('VMPEI', DoubleType(), True), StructField('VMBKL', StringType(), True), StructField('VMSAV', DoubleType(), True), StructField('VJKUM', DoubleType(), True), StructField('VJSAL', DoubleType(), True), StructField('VJVPR', StringType(), True), StructField('VJVER', DoubleType(), True), StructField('VJSTP', DoubleType(), True), StructField('VJPEI', DoubleType(), True), StructField('VJBKL', StringType(), True), StructField('VJSAV', DoubleType(), True), StructField('LFGJA', StringType(), True), StructField('LFMON', StringType(), True), StructField('BWTTY', StringType(), True), StructField('STPRV', DoubleType(), True), StructField('LAEPR', DateType(), True), StructField('ZKPRS', DoubleType(), True), StructField('ZKDAT', DateType(), True), StructField('BWPRS', DoubleType(), True), StructField('BWPRH', DoubleType(), True), StructField('VJBWS', DoubleType(), True), StructField('VJBWH', DoubleType(), True), StructField('VVJSL', DoubleType(), True), StructField('VVJLB', DoubleType(), True), StructField('VVMLB', DoubleType(), True), StructField('VVSAL', DoubleType(), True), StructField('ZPLPR', DoubleType(), True), StructField('ZPLP1', DoubleType(), True), StructField('ZPLP2', DoubleType(), True), StructField('ZPLP3', DoubleType(), True), StructField('ZPLD1', DateType(), True), StructField('ZPLD2', DateType(), True), StructField('ZPLD3', DateType(), True), StructField('PPERZ', StringType(), True), StructField('PPERL', StringType(), True), StructField('PPERV', StringType(), True), StructField('KALKZ', StringType(), True), StructField('KALKL', StringType(), True), StructField('KALKV', StringType(), True), StructField('KALSC', StringType(), True), StructField('XLIFO', StringType(), True), StructField('MYPOL', StringType(), True), StructField('BWPH1', DoubleType(), True), StructField('BWPS1', DoubleType(), True), StructField('ABWKZ', StringType(), True), StructField('PSTAT', StringType(), True), StructField('KALN1', StringType(), True), StructField('KALNR', StringType(), True), StructField('BWVA1', StringType(), True), StructField('BWVA2', StringType(), True), StructField('BWVA3', StringType(), True), StructField('VERS1', StringType(), True), StructField('VERS2', StringType(), True), StructField('VERS3', StringType(), True), StructField('HRKFT', StringType(), True), StructField('KOSGR', StringType(), True), StructField('PPRDZ', StringType(), True), StructField('PPRDL', StringType(), True), StructField('PPRDV', StringType(), True), StructField('PDATZ', StringType(), True), StructField('PDATL', StringType(), True), StructField('PDATV', StringType(), True), StructField('EKALR', StringType(), True), StructField('VPLPR', DoubleType(), True), StructField('MLMAA', StringType(), True), StructField('MLAST', StringType(), True), StructField('LPLPR', DoubleType(), True), StructField('VKSAL', DoubleType(), True), StructField('HKMAT', StringType(), True), StructField('SPERW', StringType(), True), StructField('KZIWL', StringType(), True), StructField('WLINL', DateType(), True), StructField('ABCIW', StringType(), True), StructField('BWSPA', DoubleType(), True), StructField('LPLPX', DoubleType(), True), StructField('VPLPX', DoubleType(), True), StructField('FPLPX', DoubleType(), True), StructField('LBWST', StringType(), True), StructField('VBWST', StringType(), True), StructField('FBWST', StringType(), True), StructField('EKLAS', StringType(), True), StructField('QKLAS', StringType(), True), StructField('MTUSE', StringType(), True), StructField('MTORG', StringType(), True), StructField('OWNPR', StringType(), True), StructField('XBEWM', StringType(), True), StructField('BWPEI', DoubleType(), True), StructField('MBRUE', StringType(), True), StructField('OKLAS', StringType(), True), StructField('OIPPINV', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:37,674 - code.main - INFO - Successfully created DataFrame for table: MBEW
2024-12-01 15:33:37,674 - code.main - INFO - Successfully created DataFrame: MBEW
2024-12-01 15:33:37,674 - code.main - INFO - Creating DataFrame for table: T001W
2024-12-01 15:33:37,674 - code.main - INFO - Schema retrieved for table: T001W
2024-12-01 15:33:37,674 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('WERKS', StringType(), True), StructField('NAME1', StringType(), True), StructField('BWKEY', StringType(), True), StructField('KUNNR', StringType(), True), StructField('LIFNR', StringType(), True), StructField('FABKL', StringType(), True), StructField('NAME2', StringType(), True), StructField('STRAS', StringType(), True), StructField('PFACH', StringType(), True), StructField('PSTLZ', StringType(), True), StructField('ORT01', StringType(), True), StructField('EKORG', StringType(), True), StructField('VKORG', StringType(), True), StructField('CHAZV', StringType(), True), StructField('KKOWK', StringType(), True), StructField('KORDB', StringType(), True), StructField('BEDPL', StringType(), True), StructField('LAND1', StringType(), True), StructField('REGIO', StringType(), True), StructField('COUNC', StringType(), True), StructField('CITYC', StringType(), True), StructField('ADRNR', StringType(), True), StructField('IWERK', StringType(), True), StructField('TXJCD', StringType(), True), StructField('VTWEG', StringType(), True), StructField('SPART', StringType(), True), StructField('SPRAS', StringType(), True), StructField('WKSOP', StringType(), True), StructField('AWSLS', StringType(), True), StructField('CHAZV_OLD', StringType(), True), StructField('VLFKZ', StringType(), True), StructField('BZIRK', StringType(), True), StructField('ZONE1', StringType(), True), StructField('TAXIW', StringType(), True), StructField('BZQHL', StringType(), True), StructField('LET01', DoubleType(), True), StructField('LET02', DoubleType(), True), StructField('LET03', DoubleType(), True), StructField('TXNAM_MA1', StringType(), True), StructField('TXNAM_MA2', StringType(), True), StructField('TXNAM_MA3', StringType(), True), StructField('BETOL', StringType(), True), StructField('J_1BBRANCH', StringType(), True), StructField('VTBFI', StringType(), True), StructField('FPRFW', StringType(), True), StructField('ACHVM', StringType(), True), StructField('DVSART', StringType(), True), StructField('NODETYPE', StringType(), True), StructField('NSCHEMA', StringType(), True), StructField('PKOSA', StringType(), True), StructField('MISCH', StringType(), True), StructField('MGVUPD', StringType(), True), StructField('VSTEL', StringType(), True), StructField('MGVLAUPD', StringType(), True), StructField('SOURCING', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:37,688 - code.main - INFO - Successfully created DataFrame for table: T001W
2024-12-01 15:33:37,688 - code.main - INFO - Successfully created DataFrame: T001W
2024-12-01 15:33:37,688 - code.main - INFO - Creating DataFrame for table: T001K
2024-12-01 15:33:37,688 - code.main - INFO - Schema retrieved for table: T001K
2024-12-01 15:33:37,688 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BWKEY', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BWMOD', StringType(), True), StructField('XBKNG', StringType(), True), StructField('MLBWA', StringType(), True), StructField('MLBWV', StringType(), True), StructField('XVKBW', StringType(), True), StructField('ERKLAERKOM', StringType(), True), StructField('UPROF', StringType(), True), StructField('WBPRO', StringType(), True), StructField('MLAST', StringType(), True), StructField('MLASV', StringType(), True), StructField('BDIFP', DoubleType(), True), StructField('XLBPD', StringType(), True), StructField('XEWRX', StringType(), True), StructField('X2FDO', StringType(), True), StructField('PRSFR', StringType(), True), StructField('MLCCS', StringType(), True), StructField('XEFRE', StringType(), True), StructField('EFREJ', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:37,724 - code.main - INFO - Successfully created DataFrame for table: T001K
2024-12-01 15:33:37,725 - code.main - INFO - Successfully created DataFrame: T001K
2024-12-01 15:33:37,725 - code.main - INFO - Creating DataFrame for table: T001
2024-12-01 15:33:37,725 - code.main - INFO - Schema retrieved for table: T001
2024-12-01 15:33:37,725 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('BUTXT', StringType(), True), StructField('ORT01', StringType(), True), StructField('LAND1', StringType(), True), StructField('WAERS', StringType(), True), StructField('SPRAS', StringType(), True), StructField('KTOPL', StringType(), True), StructField('WAABW', StringType(), True), StructField('PERIV', StringType(), True), StructField('KOKFI', StringType(), True), StructField('RCOMP', StringType(), True), StructField('ADRNR', StringType(), True), StructField('STCEG', StringType(), True), StructField('FIKRS', StringType(), True), StructField('XFMCO', StringType(), True), StructField('XFMCB', StringType(), True), StructField('XFMCA', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FMHRDATE', DateType(), True), StructField('BUVAR', StringType(), True), StructField('FDBUK', StringType(), True), StructField('XFDIS', StringType(), True), StructField('XVALV', StringType(), True), StructField('XSKFN', StringType(), True), StructField('KKBER', StringType(), True), StructField('XMWSN', StringType(), True), StructField('MREGL', StringType(), True), StructField('XGSBE', StringType(), True), StructField('XGJRV', StringType(), True), StructField('XKDFT', StringType(), True), StructField('XPROD', StringType(), True), StructField('XEINK', StringType(), True), StructField('XJVAA', StringType(), True), StructField('XVVWA', StringType(), True), StructField('XSLTA', StringType(), True), StructField('XFDMM', StringType(), True), StructField('XFDSD', StringType(), True), StructField('XEXTB', StringType(), True), StructField('EBUKR', StringType(), True), StructField('KTOP2', StringType(), True), StructField('UMKRS', StringType(), True), StructField('BUKRS_GLOB', StringType(), True), StructField('FSTVA', StringType(), True), StructField('OPVAR', StringType(), True), StructField('XCOVR', StringType(), True), StructField('TXKRS', StringType(), True), StructField('WFVAR', StringType(), True), StructField('XBBBF', StringType(), True), StructField('XBBBE', StringType(), True), StructField('XBBBA', StringType(), True), StructField('XBBKO', StringType(), True), StructField('XSTDT', StringType(), True), StructField('MWSKV', StringType(), True), StructField('MWSKA', StringType(), True), StructField('IMPDA', StringType(), True), StructField('XNEGP', StringType(), True), StructField('XKKBI', StringType(), True), StructField('WT_NEWWT', StringType(), True), StructField('PP_PDATE', StringType(), True), StructField('INFMT', StringType(), True), StructField('FSTVARE', StringType(), True), StructField('KOPIM', StringType(), True), StructField('DKWEG', StringType(), True), StructField('OFFSACCT', StringType(), True), StructField('BAPOVAR', StringType(), True), StructField('XCOS', StringType(), True), StructField('XCESSION', StringType(), True), StructField('XSPLT', StringType(), True), StructField('SURCCM', StringType(), True), StructField('DTPROV', StringType(), True), StructField('DTAMTC', StringType(), True), StructField('DTTAXC', StringType(), True), StructField('DTTDSP', StringType(), True), StructField('FM_DERIVE_ACC', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:37,744 - code.main - INFO - Successfully created DataFrame for table: T001
2024-12-01 15:33:37,744 - code.main - INFO - Successfully created DataFrame: T001
2024-12-01 15:33:37,744 - code.main - INFO - Completed creation of 6 required DataFrames
2024-12-01 15:33:37,744 - code.main - INFO - Preparing general material data.
2024-12-01 15:33:37,744 - code.main - INFO - Starting preparation of general material data
2024-12-01 15:33:37,751 - code.main - INFO - Using 'ZZMDGM' as the global material number column
2024-12-01 15:33:37,810 - code.main - INFO - Filtered out materials with invalid old material numbers
2024-12-01 15:33:37,817 - code.main - INFO - Excluded materials flagged for deletion
2024-12-01 15:33:37,822 - code.main - INFO - Completed preparation of general material data
2024-12-01 15:33:37,822 - code.main - INFO - Preparing material valuation data.
2024-12-01 15:33:37,822 - code.main - INFO - Starting preparation of material valuation data
2024-12-01 15:33:37,896 - code.main - INFO - Completed preparation of material valuation data
2024-12-01 15:33:37,897 - code.main - INFO - Preparing plant data for material.
2024-12-01 15:33:37,897 - code.main - INFO - Starting preparation of plant data for material
2024-12-01 15:33:37,915 - code.main - INFO - Completed preparation of plant data for material
2024-12-01 15:33:37,915 - code.main - INFO - Preparing plant and branches data.
2024-12-01 15:33:37,915 - code.main - INFO - Starting preparation of plant and branches data
2024-12-01 15:33:37,920 - code.main - INFO - Completed preparation of plant and branches data
2024-12-01 15:33:37,920 - code.main - INFO - Preparing valuation area data.
2024-12-01 15:33:37,920 - code.main - INFO - Starting preparation of valuation area data
2024-12-01 15:33:37,930 - code.main - INFO - Selected 3 required columns
2024-12-01 15:33:37,933 - code.main - INFO - Completed preparation of valuation area data
2024-12-01 15:33:37,933 - code.main - INFO - Preparing company codes data.
2024-12-01 15:33:37,933 - code.main - INFO - Starting preparation of company codes data
2024-12-01 15:33:37,939 - code.main - INFO - Selected 3 required columns
2024-12-01 15:33:37,939 - code.main - INFO - Completed preparation of company codes data
2024-12-01 15:33:37,939 - code.main - INFO - Integrating prepared data.
2024-12-01 15:33:37,939 - code.main - INFO - Starting integration of SAP tables
2024-12-01 15:33:37,939 - code.main - INFO - Adding prefixes to DataFrames
2024-12-01 15:33:37,939 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:37,939 - code.main - INFO - Prefixing columns with prefix 'marc' excluding columns: []
2024-12-01 15:33:37,944 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:37,944 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:37,944 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:33:37,950 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:37,950 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:37,950 - code.main - INFO - Prefixing columns with prefix 'mbew' excluding columns: []
2024-12-01 15:33:37,960 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:37,960 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:37,960 - code.main - INFO - Prefixing columns with prefix 't001k' excluding columns: []
2024-12-01 15:33:37,966 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:37,966 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:37,966 - code.main - INFO - Prefixing columns with prefix 't001w' excluding columns: []
2024-12-01 15:33:37,972 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:37,972 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:37,973 - code.main - INFO - Prefixing columns with prefix 't001' excluding columns: []
2024-12-01 15:33:37,979 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:37,979 - code.main - INFO - Logging columns of each prefixed DataFrame
2024-12-01 15:33:37,985 - code.main - INFO - Joining MARC with MARA
2024-12-01 15:33:37,997 - code.main - INFO - Successfully joined MARC with MARA
2024-12-01 15:33:37,997 - code.main - INFO - Joining result with T001W
2024-12-01 15:33:38,008 - code.main - INFO - Successfully joined result with T001W
2024-12-01 15:33:38,008 - code.main - INFO - Joining result with MBEW
2024-12-01 15:33:38,018 - code.main - INFO - Successfully joined result with MBEW
2024-12-01 15:33:38,019 - code.main - INFO - Joining result with T001K
2024-12-01 15:33:38,029 - code.main - INFO - Successfully joined result with T001K
2024-12-01 15:33:38,029 - code.main - INFO - Joining result with T001
2024-12-01 15:33:38,041 - code.main - INFO - Successfully joined result with T001
2024-12-01 15:33:38,041 - code.main - INFO - Removing duplicate key columns
2024-12-01 15:33:38,048 - code.main - INFO - Dropped duplicate columns: ['mara_MANDT', 'mara_MATNR', 't001w_MANDT', 't001w_WERKS', 'mbew_MANDT', 'mbew_MATNR', 'mbew_BWKEY', 't001k_MANDT', 't001k_BWKEY', 't001k_BUKRS', 't001_MANDT', 't001_BUKRS']
2024-12-01 15:33:38,048 - code.main - INFO - Removing prefixes from column names
2024-12-01 15:33:38,048 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:33:38,095 - code.main - INFO - Removed prefixes from columns: {'marc_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'marc_MATNR': 'MATNR', 'marc_WERKS': 'WERKS', 'mara_MEINS': 'MEINS', 'mara_global_material_number': 'global_material_number', 't001w_BWKEY': 'BWKEY', 't001w_NAME1': 'NAME1', 'mbew_VPRSV': 'VPRSV', 'mbew_VERPR': 'VERPR', 'mbew_STPRS': 'STPRS', 'mbew_PEINH': 'PEINH', 'mbew_BKLAS': 'BKLAS', 't001_WAERS': 'WAERS'}
2024-12-01 15:33:38,095 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:33:39,575 - code.main - INFO - Number of rows in the final integrated DataFrame: 13
2024-12-01 15:33:39,575 - code.main - INFO - Completed integration of SAP tables
2024-12-01 15:33:39,575 - code.main - INFO - Post-processing local material.
2024-12-01 15:33:39,575 - code.main - INFO - Starting post-processing of local material data
2024-12-01 15:33:39,607 - code.main - INFO - Added column: mtl_plant_emd
2024-12-01 15:33:39,619 - code.main - INFO - Added column: global_mtl_id
2024-12-01 15:33:39,619 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:33:39,619 - code.main - INFO - Using columns ['MATNR', 'WERKS'] for primary key generation
2024-12-01 15:33:39,619 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:33:39,627 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:33:39,636 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:33:39,636 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:33:39,636 - code.main - INFO - Added columns: primary_key_intra, primary_key_inter
2024-12-01 15:33:39,636 - code.main - INFO - Handling duplicates based on 'SOURCE_SYSTEM_ERP', 'MATNR', 'WERKS'
2024-12-01 15:33:39,651 - code.main - INFO - Added column: no_of_duplicates
2024-12-01 15:33:41,363 - code.main - INFO - Initial row count before dropping duplicates: 13
2024-12-01 15:33:42,023 - code.main - INFO - Removed 0 duplicate rows
2024-12-01 15:33:42,031 - code.main - INFO - Completed post-processing of local material data
2024-12-01 15:33:42,031 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:33:42,031 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:33:42,031 - code.main - INFO - Writing the data for system: PRD and table_name: LOCAL_MATERIAL
2024-12-01 15:33:42,031 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:33:44,518 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/LOCAL_MATERIAL/
2024-12-01 15:33:44,518 - code.main - INFO - Status of the validate and write: True
2024-12-01 15:33:44,518 - code.main - INFO - Local Material processing complete for system: PRD
2024-12-01 15:33:44,518 - code.main - INFO - Starting process order processing.
2024-12-01 15:33:44,518 - code.main - INFO - Loading required dataframes.
2024-12-01 15:33:44,518 - code.main - INFO - Creating required dataframes for process order.
2024-12-01 15:33:44,518 - code.main - INFO - Starting creation of required DataFrames
2024-12-01 15:33:44,518 - code.main - INFO - Creating DataFrame for table: AFKO
2024-12-01 15:33:44,518 - code.main - INFO - Schema retrieved for table: AFKO
2024-12-01 15:33:44,518 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('RSNUM', StringType(), True), StructField('GASMG', DoubleType(), True), StructField('GAMNG', DoubleType(), True), StructField('GMEIN', StringType(), True), StructField('PLNBEZ', StringType(), True), StructField('PLNTY', StringType(), True), StructField('PLNNR', StringType(), True), StructField('PLNAW', StringType(), True), StructField('PLNAL', StringType(), True), StructField('PVERW', StringType(), True), StructField('PLAUF', DateType(), True), StructField('PLSVB', DoubleType(), True), StructField('PLNME', StringType(), True), StructField('PLSVN', DoubleType(), True), StructField('PDATV', DateType(), True), StructField('PAENR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('LODIV', DoubleType(), True), StructField('STLTY', StringType(), True), StructField('STLBEZ', StringType(), True), StructField('STLST', StringType(), True), StructField('STLNR', StringType(), True), StructField('SDATV', DateType(), True), StructField('SBMNG', DoubleType(), True), StructField('SBMEH', StringType(), True), StructField('SAENR', StringType(), True), StructField('STLAL', StringType(), True), StructField('STLAN', StringType(), True), StructField('SLSVN', DoubleType(), True), StructField('SLSBS', DoubleType(), True), StructField('AUFLD', DateType(), True), StructField('DISPO', StringType(), True), StructField('AUFPL', StringType(), True), StructField('FEVOR', StringType(), True), StructField('FHORI', StringType(), True), StructField('TERKZ', StringType(), True), StructField('REDKZ', StringType(), True), StructField('APRIO', StringType(), True), StructField('NTZUE', StringType(), True), StructField('VORUE', StringType(), True), StructField('PROFID', StringType(), True), StructField('VORGZ', StringType(), True), StructField('SICHZ', StringType(), True), StructField('FREIZ', StringType(), True), StructField('UPTER', StringType(), True), StructField('BEDID', StringType(), True), StructField('PRONR', StringType(), True), StructField('ZAEHL', StringType(), True), StructField('MZAEHL', StringType(), True), StructField('ZKRIZ', StringType(), True), StructField('PRUEFLOS', StringType(), True), StructField('KLVARP', StringType(), True), StructField('KLVARI', StringType(), True), StructField('RGEKZ', StringType(), True), StructField('PLART', StringType(), True), StructField('FLG_AOB', StringType(), True), StructField('FLG_ARBEI', StringType(), True), StructField('GLTPP', DateType(), True), StructField('GSTPP', DateType(), True), StructField('GLTPS', DateType(), True), StructField('GSTPS', DateType(), True), StructField('FTRPS', DateType(), True), StructField('RDKZP', StringType(), True), StructField('TRKZP', StringType(), True), StructField('RUECK', StringType(), True), StructField('RMZHL', StringType(), True), StructField('IGMNG', DoubleType(), True), StructField('RATID', StringType(), True), StructField('GROID', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('GLUZS', StringType(), True), StructField('GSUZS', StringType(), True), StructField('REVLV', StringType(), True), StructField('RSHTY', StringType(), True), StructField('RSHID', StringType(), True), StructField('RSNTY', StringType(), True), StructField('RSNID', StringType(), True), StructField('NAUTERM', StringType(), True), StructField('NAUCOST', StringType(), True), StructField('STUFE', DoubleType(), True), StructField('WEGXX', DoubleType(), True), StructField('VWEGX', DoubleType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('MAUFNR', StringType(), True), StructField('LKNOT', StringType(), True), StructField('RKNOT', StringType(), True), StructField('PRODNET', StringType(), True), StructField('IASMG', DoubleType(), True), StructField('ABARB', StringType(), True), StructField('AUFNT', StringType(), True), StructField('AUFPT', StringType(), True), StructField('APLZT', StringType(), True), StructField('NO_DISP', StringType(), True), StructField('CSPLIT', StringType(), True), StructField('AENNR', StringType(), True), StructField('CY_SEQNR', StringType(), True), StructField('BREAKS', StringType(), True), StructField('VORGZ_TRM', DoubleType(), True), StructField('SICHZ_TRM', DoubleType(), True), StructField('TRMDT', DateType(), True), StructField('GLUZP', StringType(), True), StructField('GSUZP', StringType(), True), StructField('GSUZI', StringType(), True), StructField('GEUZI', StringType(), True), StructField('GLUPP', StringType(), True), StructField('GSUPP', StringType(), True), StructField('GLUPS', StringType(), True), StructField('GSUPS', StringType(), True), StructField('CHSCH', StringType(), True), StructField('KAPT_VORGZ', StringType(), True), StructField('KAPT_SICHZ', StringType(), True), StructField('LEAD_AUFNR', StringType(), True), StructField('PNETSTARTD', DateType(), True), StructField('PNETSTARTT', StringType(), True), StructField('PNETENDD', DateType(), True), StructField('PNETENDT', StringType(), True), StructField('KBED', StringType(), True), StructField('KKALKR', StringType(), True), StructField('SFCPF', StringType(), True), StructField('RMNGA', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('VFMNG', DoubleType(), True), StructField('NOPCOST', StringType(), True), StructField('NETZKONT', StringType(), True), StructField('ATRKZ', StringType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('KAPVERSA', StringType(), True), StructField('COLORDPROC', StringType(), True), StructField('KZERB', StringType(), True), StructField('CONF_KEY', StringType(), True), StructField('ST_ARBID', StringType(), True), StructField('VSNMR_V', StringType(), True), StructField('TERHW', StringType(), True), StructField('SPLSTAT', StringType(), True), StructField('COSTUPD', StringType(), True), StructField('RMANR', StringType(), True), StructField('POSNR_RMA', StringType(), True), StructField('POSNV_RMA', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:33:44,646 - code.main - INFO - Successfully created DataFrame for table: AFKO
2024-12-01 15:33:44,646 - code.main - INFO - Successfully created DataFrame: AFKO
2024-12-01 15:33:44,646 - code.main - INFO - Creating DataFrame for table: AFPO
2024-12-01 15:33:44,646 - code.main - INFO - Schema retrieved for table: AFPO
2024-12-01 15:33:44,646 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('POSNR', StringType(), True), StructField('PSOBS', StringType(), True), StructField('QUNUM', StringType(), True), StructField('QUPOS', StringType(), True), StructField('PROJN', StringType(), True), StructField('PLNUM', StringType(), True), StructField('STRMP', DateType(), True), StructField('ETRMP', DateType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('KDEIN', StringType(), True), StructField('BESKZ', StringType(), True), StructField('PSAMG', DoubleType(), True), StructField('PSMNG', DoubleType(), True), StructField('WEMNG', DoubleType(), True), StructField('IAMNG', DoubleType(), True), StructField('AMEIN', StringType(), True), StructField('MEINS', StringType(), True), StructField('MATNR', StringType(), True), StructField('PAMNG', DoubleType(), True), StructField('PGMNG', DoubleType(), True), StructField('KNTTP', StringType(), True), StructField('TPAUF', StringType(), True), StructField('LTRMI', DateType(), True), StructField('LTRMP', DateType(), True), StructField('KALNR', StringType(), True), StructField('UEBTO', DoubleType(), True), StructField('UEBTK', StringType(), True), StructField('UNTTO', DoubleType(), True), StructField('INSMK', StringType(), True), StructField('WEPOS', StringType(), True), StructField('BWTAR', StringType(), True), StructField('BWTTY', StringType(), True), StructField('PWERK', StringType(), True), StructField('LGORT', StringType(), True), StructField('UMREZ', DoubleType(), True), StructField('UMREN', DoubleType(), True), StructField('WEBAZ', DoubleType(), True), StructField('ELIKZ', StringType(), True), StructField('SAFNR', StringType(), True), StructField('VERID', StringType(), True), StructField('SERNR', StringType(), True), StructField('TECHS', StringType(), True), StructField('DWERK', StringType(), True), StructField('DAUTY', StringType(), True), StructField('DAUAT', StringType(), True), StructField('DGLTP', DateType(), True), StructField('DGLTS', DateType(), True), StructField('DFREI', StringType(), True), StructField('DNREL', StringType(), True), StructField('VERTO', StringType(), True), StructField('SOBKZ', StringType(), True), StructField('KZVBR', StringType(), True), StructField('WEWRT', DoubleType(), True), StructField('WEUNB', StringType(), True), StructField('ABLAD', StringType(), True), StructField('WEMPF', StringType(), True), StructField('CHARG', StringType(), True), StructField('GSBER', StringType(), True), StructField('WEAED', StringType(), True), StructField('CUOBJ', StringType(), True), StructField('KBNKZ', StringType(), True), StructField('ARSNR', StringType(), True), StructField('ARSPS', StringType(), True), StructField('KRSNR', StringType(), True), StructField('KRSPS', StringType(), True), StructField('KCKEY', StringType(), True), StructField('RTP01', StringType(), True), StructField('RTP02', StringType(), True), StructField('RTP03', StringType(), True), StructField('RTP04', StringType(), True), StructField('KSVON', DateType(), True), StructField('KSBIS', DateType(), True), StructField('OBJNP', StringType(), True), StructField('NDISR', StringType(), True), StructField('VFMNG', DoubleType(), True), StructField('GSBTR', DateType(), True), StructField('KZAVC', StringType(), True), StructField('KZBWS', StringType(), True), StructField('XLOEK', StringType(), True), StructField('SERNP', StringType(), True), StructField('ANZSN', IntegerType(), True), StructField('OBJTYPE', StringType(), True), StructField('CH_PROC', StringType(), True), StructField('FXPRU', StringType(), True), StructField('CUOBJ_ROOT', StringType(), True), StructField('BERID', StringType(), True), StructField('TECHS_COPY', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True), StructField('SOURCE_SYSTEM_ERP', StringType(), True)])
2024-12-01 15:33:44,674 - code.main - INFO - Successfully created DataFrame for table: AFPO
2024-12-01 15:33:44,674 - code.main - INFO - Successfully created DataFrame: AFPO
2024-12-01 15:33:44,674 - code.main - INFO - Creating DataFrame for table: AUFK
2024-12-01 15:33:44,674 - code.main - INFO - Schema retrieved for table: AUFK
2024-12-01 15:33:44,674 - code.main - INFO - provided schema, StructType([StructField('AUFNR', StringType(), True), StructField('MANDT', StringType(), True), StructField('AUART', StringType(), True), StructField('AUTYP', StringType(), True), StructField('REFNR', StringType(), True), StructField('ERNAM', StringType(), True), StructField('ERDAT', DateType(), True), StructField('AENAM', StringType(), True), StructField('AEDAT', DateType(), True), StructField('KTEXT', StringType(), True), StructField('LTEXT', StringType(), True), StructField('BUKRS', StringType(), True), StructField('WERKS', StringType(), True), StructField('GSBER', StringType(), True), StructField('KOKRS', StringType(), True), StructField('CCKEY', StringType(), True), StructField('KOSTV', StringType(), True), StructField('STORT', StringType(), True), StructField('SOWRK', StringType(), True), StructField('ASTKZ', StringType(), True), StructField('WAERS', StringType(), True), StructField('ASTNR', StringType(), True), StructField('STDAT', DateType(), True), StructField('ESTNR', StringType(), True), StructField('PHAS0', StringType(), True), StructField('PHAS1', StringType(), True), StructField('PHAS2', StringType(), True), StructField('PHAS3', StringType(), True), StructField('PDAT1', DateType(), True), StructField('PDAT2', DateType(), True), StructField('PDAT3', DateType(), True), StructField('IDAT1', DateType(), True), StructField('IDAT2', DateType(), True), StructField('IDAT3', DateType(), True), StructField('OBJID', StringType(), True), StructField('VOGRP', StringType(), True), StructField('LOEKZ', StringType(), True), StructField('PLGKZ', StringType(), True), StructField('KVEWE', StringType(), True), StructField('KAPPL', StringType(), True), StructField('KALSM', StringType(), True), StructField('ZSCHL', StringType(), True), StructField('ABKRS', StringType(), True), StructField('KSTAR', StringType(), True), StructField('KOSTL', StringType(), True), StructField('SAKNR', StringType(), True), StructField('SETNM', StringType(), True), StructField('CYCLE', StringType(), True), StructField('SDATE', DateType(), True), StructField('SEQNR', StringType(), True), StructField('USER0', StringType(), True), StructField('USER1', StringType(), True), StructField('USER2', StringType(), True), StructField('USER3', StringType(), True), StructField('USER4', DoubleType(), True), StructField('USER5', DateType(), True), StructField('USER6', StringType(), True), StructField('USER7', DateType(), True), StructField('USER8', DateType(), True), StructField('USER9', StringType(), True), StructField('OBJNR', StringType(), True), StructField('PRCTR', StringType(), True), StructField('PSPEL', StringType(), True), StructField('AWSLS', StringType(), True), StructField('ABGSL', StringType(), True), StructField('TXJCD', StringType(), True), StructField('FUNC_AREA', StringType(), True), StructField('SCOPE', StringType(), True), StructField('PLINT', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFEX', StringType(), True), StructField('IVPRO', StringType(), True), StructField('LOGSYSTEM', StringType(), True), StructField('FLG_MLTPS', StringType(), True), StructField('ABUKR', StringType(), True), StructField('AKSTL', StringType(), True), StructField('SIZECL', StringType(), True), StructField('IZWEK', StringType(), True), StructField('UMWKZ', StringType(), True), StructField('KSTEMPF', StringType(), True), StructField('ZSCHM', StringType(), True), StructField('PKOSA', StringType(), True), StructField('ANFAUFNR', StringType(), True), StructField('PROCNR', StringType(), True), StructField('PROTY', StringType(), True), StructField('RSORD', StringType(), True), StructField('BEMOT', StringType(), True), StructField('ADRNRA', StringType(), True), StructField('ERFZEIT', StringType(), True), StructField('AEZEIT', StringType(), True), StructField('CSTG_VRNT', StringType(), True), StructField('COSTESTNR', StringType(), True), StructField('ZZPRO_RSCHL_CD', StringType(), True), StructField('ZZBDDAT', DateType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('ZZSP_REVIEW', StringType(), True), StructField('ZZPLPRDSTART', DateType(), True), StructField('ZZCUSTSO', StringType(), True), StructField('ZZCUSTNAME', StringType(), True), StructField('ZZITPROJECT', StringType(), True), StructField('ZZTARGETSTR', StringType(), True), StructField('VNAME', StringType(), True), StructField('RECID', StringType(), True), StructField('ETYPE', StringType(), True), StructField('OTYPE', StringType(), True), StructField('JV_JIBCL', StringType(), True), StructField('JV_JIBSA', StringType(), True), StructField('JV_OCO', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZSUB_BUSNSEG', StringType(), True), StructField('ZZPRODH_L1', StringType(), True), StructField('ZZPRODH_L2', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:44,694 - code.main - INFO - Successfully created DataFrame for table: AUFK
2024-12-01 15:33:44,694 - code.main - INFO - Successfully created DataFrame: AUFK
2024-12-01 15:33:44,694 - code.main - INFO - Creating DataFrame for table: MARA
2024-12-01 15:33:44,694 - code.main - INFO - Schema retrieved for table: MARA
2024-12-01 15:33:44,694 - code.main - INFO - provided schema, StructType([StructField('MANDT', StringType(), True), StructField('MATNR', StringType(), True), StructField('ERSDA', DateType(), True), StructField('ERNAM', StringType(), True), StructField('LAEDA', DateType(), True), StructField('AENAM', StringType(), True), StructField('VPSTA', StringType(), True), StructField('PSTAT', StringType(), True), StructField('LVORM', StringType(), True), StructField('MTART', StringType(), True), StructField('MBRSH', StringType(), True), StructField('MATKL', StringType(), True), StructField('BISMT', StringType(), True), StructField('MEINS', StringType(), True), StructField('BSTME', StringType(), True), StructField('ZEINR', StringType(), True), StructField('ZEIAR', StringType(), True), StructField('ZEIVR', StringType(), True), StructField('ZEIFO', StringType(), True), StructField('AESZN', StringType(), True), StructField('BLATT', StringType(), True), StructField('BLANZ', StringType(), True), StructField('FERTH', StringType(), True), StructField('FORMT', StringType(), True), StructField('GROES', StringType(), True), StructField('WRKST', StringType(), True), StructField('NORMT', StringType(), True), StructField('LABOR', StringType(), True), StructField('EKWSL', StringType(), True), StructField('BRGEW', DoubleType(), True), StructField('NTGEW', DoubleType(), True), StructField('GEWEI', StringType(), True), StructField('VOLUM', DoubleType(), True), StructField('VOLEH', StringType(), True), StructField('BEHVO', StringType(), True), StructField('RAUBE', StringType(), True), StructField('TEMPB', StringType(), True), StructField('DISST', StringType(), True), StructField('TRAGR', StringType(), True), StructField('STOFF', StringType(), True), StructField('SPART', StringType(), True), StructField('KUNNR', StringType(), True), StructField('EANNR', StringType(), True), StructField('WESCH', DoubleType(), True), StructField('BWVOR', StringType(), True), StructField('BWSCL', StringType(), True), StructField('SAISO', StringType(), True), StructField('ETIAR', StringType(), True), StructField('ETIFO', StringType(), True), StructField('ENTAR', StringType(), True), StructField('EAN11', StringType(), True), StructField('NUMTP', StringType(), True), StructField('LAENG', DoubleType(), True), StructField('BREIT', DoubleType(), True), StructField('HOEHE', DoubleType(), True), StructField('MEABM', StringType(), True), StructField('PRDHA', StringType(), True), StructField('AEKLK', StringType(), True), StructField('CADKZ', StringType(), True), StructField('QMPUR', StringType(), True), StructField('ERGEW', DoubleType(), True), StructField('ERGEI', StringType(), True), StructField('ERVOL', DoubleType(), True), StructField('ERVOE', StringType(), True), StructField('GEWTO', DoubleType(), True), StructField('VOLTO', DoubleType(), True), StructField('VABME', StringType(), True), StructField('KZREV', StringType(), True), StructField('KZKFG', StringType(), True), StructField('XCHPF', StringType(), True), StructField('VHART', StringType(), True), StructField('FUELG', DoubleType(), True), StructField('STFAK', IntegerType(), True), StructField('MAGRV', StringType(), True), StructField('BEGRU', StringType(), True), StructField('DATAB', DateType(), True), StructField('LIQDT', DateType(), True), StructField('SAISJ', StringType(), True), StructField('PLGTP', StringType(), True), StructField('MLGUT', StringType(), True), StructField('EXTWG', StringType(), True), StructField('SATNR', StringType(), True), StructField('ATTYP', StringType(), True), StructField('KZKUP', StringType(), True), StructField('KZNFM', StringType(), True), StructField('PMATA', StringType(), True), StructField('MSTAE', StringType(), True), StructField('MSTAV', StringType(), True), StructField('MSTDE', DateType(), True), StructField('MSTDV', DateType(), True), StructField('TAKLV', StringType(), True), StructField('RBNRM', StringType(), True), StructField('MHDRZ', DoubleType(), True), StructField('MHDHB', DoubleType(), True), StructField('MHDLP', DoubleType(), True), StructField('INHME', StringType(), True), StructField('INHAL', DoubleType(), True), StructField('VPREH', DoubleType(), True), StructField('ETIAG', StringType(), True), StructField('INHBR', DoubleType(), True), StructField('CMETH', StringType(), True), StructField('CUOBF', StringType(), True), StructField('KZUMW', StringType(), True), StructField('KOSCH', StringType(), True), StructField('SPROF', StringType(), True), StructField('NRFHG', StringType(), True), StructField('MFRPN', StringType(), True), StructField('MFRNR', StringType(), True), StructField('BMATN', StringType(), True), StructField('MPROF', StringType(), True), StructField('KZWSM', StringType(), True), StructField('SAITY', StringType(), True), StructField('PROFL', StringType(), True), StructField('IHIVI', StringType(), True), StructField('ILOOS', StringType(), True), StructField('SERLV', StringType(), True), StructField('KZGVH', StringType(), True), StructField('XGCHP', StringType(), True), StructField('KZEFF', StringType(), True), StructField('COMPL', StringType(), True), StructField('IPRKZ', StringType(), True), StructField('RDMHD', StringType(), True), StructField('PRZUS', StringType(), True), StructField('MTPOS_MARA', StringType(), True), StructField('BFLME', StringType(), True), StructField('MATFI', StringType(), True), StructField('CMREL', StringType(), True), StructField('BBTYP', StringType(), True), StructField('SLED_BBD', StringType(), True), StructField('GTIN_VARIANT', StringType(), True), StructField('GENNR', StringType(), True), StructField('RMATP', StringType(), True), StructField('ZZOLDPRODH', StringType(), True), StructField('ZZBUSNSEG', StringType(), True), StructField('ZZPRDINIT', StringType(), True), StructField('ZZPCKQTY', StringType(), True), StructField('ZZPCKQUOM', StringType(), True), StructField('ZZCASEQTY', StringType(), True), StructField('ZZPKGSORTKEY', StringType(), True), StructField('ZZPKGDESC', StringType(), True), StructField('ZZMDL', StringType(), True), StructField('ZZOUTR_PCKGNG', StringType(), True), StructField('ZZREL', StringType(), True), StructField('ZZRELCODE', StringType(), True), StructField('ZZPKGCAPACITY', StringType(), True), StructField('ZZMAT_SEG', StringType(), True), StructField('ZZNPH', StringType(), True), StructField('ZZMAT_SBU', StringType(), True), StructField('ZZMAT_GPH', StringType(), True), StructField('ZZMDGM', StringType(), True), StructField('ZZMSBU_PL', StringType(), True), StructField('ZZMGPH_PL', StringType(), True), StructField('ZZORIGSRC', StringType(), True), StructField('ZZPRODMAN', StringType(), True), StructField('ZZREVCATE', StringType(), True), StructField('ZZLAUNCHD', DateType(), True), StructField('ZZPRODSTEW', StringType(), True), StructField('ZZBRAND_PF', StringType(), True), StructField('ZZICM_COGS', StringType(), True), StructField('BRAND_ID', StringType(), True), StructField('ZZTAXGROUP', StringType(), True), StructField('ZZMATTAXCLASS', StringType(), True), StructField('ZZHW_ME', StringType(), True), StructField('MATNR_CLEAN', StringType(), True), StructField('sur_pkey', StringType(), True)])
2024-12-01 15:33:44,713 - code.main - INFO - Successfully created DataFrame for table: MARA
2024-12-01 15:33:44,714 - code.main - INFO - Successfully created DataFrame: MARA
2024-12-01 15:33:44,714 - code.main - INFO - Completed creation of 4 required DataFrames
2024-12-01 15:33:44,714 - code.main - INFO - Preparing SAP order header data.
2024-12-01 15:33:44,714 - code.main - INFO - Starting prep_sap_order_header_data function
2024-12-01 15:33:44,716 - code.main - INFO - All required columns are present in df_afko
2024-12-01 15:33:44,749 - code.main - INFO - Selected 18 columns from df_afko
2024-12-01 15:33:44,749 - code.main - INFO - Creating 'start_date' column
2024-12-01 15:33:44,782 - code.main - INFO - Created 'start_date' column
2024-12-01 15:33:44,782 - code.main - INFO - Creating 'finish_date' column
2024-12-01 15:33:44,800 - code.main - INFO - Created 'finish_date' column
2024-12-01 15:33:44,800 - code.main - INFO - Successfully completed prep_sap_order_header_data function
2024-12-01 15:33:44,800 - code.main - INFO - Preparing SAP order item data.
2024-12-01 15:33:44,800 - code.main - INFO - Starting prep_sap_order_item function
2024-12-01 15:33:44,801 - code.main - INFO - All required columns are present in df_afpo
2024-12-01 15:33:44,808 - code.main - INFO - Selected 7 columns from df_afpo
2024-12-01 15:33:44,809 - code.main - INFO - Successfully completed prep_sap_order_item function
2024-12-01 15:33:44,809 - code.main - INFO - Preparing SAP order master data.
2024-12-01 15:33:44,809 - code.main - INFO - Starting prep_sap_order_master_data function
2024-12-01 15:33:44,822 - code.main - INFO - Selected 7 columns from df_aufk
2024-12-01 15:33:44,823 - code.main - INFO - Successfully completed prep_sap_order_master_data function
2024-12-01 15:33:44,823 - code.main - INFO - Preparing SAP general material data.
2024-12-01 15:33:44,823 - code.main - INFO - Fetching the global material column.
2024-12-01 15:33:44,823 - code.main - INFO - Starting prep_sap_general_material_data function
2024-12-01 15:33:44,824 - code.main - INFO - Filtering materials based on BISMT and LVORM
2024-12-01 15:33:44,847 - code.main - INFO - Filtering completed
2024-12-01 15:33:44,854 - code.main - INFO - Selected 4 columns from df_mara
2024-12-01 15:33:44,856 - code.main - INFO - Renamed column 'ZZMDGM' to 'global_material_number'
2024-12-01 15:33:44,857 - code.main - INFO - Successfully completed prep_sap_general_material_data function
2024-12-01 15:33:44,857 - code.main - INFO - Integrating prepared data.
2024-12-01 15:33:44,857 - code.main - INFO - Starting the integration of DataFrames.
2024-12-01 15:33:44,857 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:44,857 - code.main - INFO - Prefixing columns with prefix 'afko' excluding columns: []
2024-12-01 15:33:44,879 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:44,879 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:44,879 - code.main - INFO - Prefixing columns with prefix 'afpo' excluding columns: []
2024-12-01 15:33:44,890 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:44,890 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:44,890 - code.main - INFO - Prefixing columns with prefix 'aufk' excluding columns: []
2024-12-01 15:33:44,901 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:44,901 - code.main - INFO - Starting prefixing columns
2024-12-01 15:33:44,901 - code.main - INFO - Prefixing columns with prefix 'mara' excluding columns: []
2024-12-01 15:33:44,907 - code.main - INFO - Successfully prefixed columns
2024-12-01 15:33:44,907 - code.main - INFO - AFKO Dataframe: ['afko_SOURCE_SYSTEM_ERP', 'afko_MANDT', 'afko_AUFNR', 'afko_GLTRP', 'afko_GSTRP', 'afko_FTRMS', 'afko_GLTRS', 'afko_GSTRS', 'afko_GSTRI', 'afko_GETRI', 'afko_GLTRI', 'afko_FTRMI', 'afko_FTRMP', 'afko_DISPO', 'afko_FEVOR', 'afko_PLGRP', 'afko_FHORI', 'afko_AUFPL', 'afko_start_date', 'afko_finish_date']
2024-12-01 15:33:44,907 - code.main - INFO - AFPO Dataframe: ['afpo_AUFNR', 'afpo_POSNR', 'afpo_DWERK', 'afpo_MATNR', 'afpo_MEINS', 'afpo_KDAUF', 'afpo_KDPOS']
2024-12-01 15:33:44,908 - code.main - INFO - AUFK Dataframe: ['aufk_AUFNR', 'aufk_OBJNR', 'aufk_ERDAT', 'aufk_ERNAM', 'aufk_AUART', 'aufk_ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT']
2024-12-01 15:33:44,908 - code.main - INFO - MARA Dataframe: ['mara_MATNR', 'mara_global_material_number', 'mara_NTGEW', 'mara_MTART']
2024-12-01 15:33:44,915 - code.main - INFO - Join with AFPO is completed.
2024-12-01 15:33:44,922 - code.main - INFO - Join with AUFK is completed.
2024-12-01 15:33:44,942 - code.main - INFO - Join with MARA is completed.
2024-12-01 15:33:44,959 - code.main - INFO - Created column ZZGLTRP_ORIG.
2024-12-01 15:33:44,966 - code.main - INFO - Dropped duplicate key columns: ['afko_AUFNR', 'afpo_AUFNR', 'afpo_MATNR', 'mara_MATNR']
2024-12-01 15:33:44,966 - code.main - INFO - Starting to remove prefixes from column names
2024-12-01 15:33:45,128 - code.main - INFO - Removed prefixes from columns: {'afko_SOURCE_SYSTEM_ERP': 'SOURCE_SYSTEM_ERP', 'afko_MANDT': 'MANDT', 'afko_GLTRP': 'GLTRP', 'afko_GSTRP': 'GSTRP', 'afko_FTRMS': 'FTRMS', 'afko_GLTRS': 'GLTRS', 'afko_GSTRS': 'GSTRS', 'afko_GSTRI': 'GSTRI', 'afko_GETRI': 'GETRI', 'afko_GLTRI': 'GLTRI', 'afko_FTRMI': 'FTRMI', 'afko_FTRMP': 'FTRMP', 'afko_DISPO': 'DISPO', 'afko_FEVOR': 'FEVOR', 'afko_PLGRP': 'PLGRP', 'afko_FHORI': 'FHORI', 'afko_AUFPL': 'AUFPL', 'afko_start_date': 'start_date', 'afko_finish_date': 'finish_date', 'afpo_POSNR': 'POSNR', 'afpo_DWERK': 'DWERK', 'afpo_MEINS': 'MEINS', 'afpo_KDAUF': 'KDAUF', 'afpo_KDPOS': 'KDPOS', 'aufk_AUFNR': 'AUFNR', 'aufk_OBJNR': 'OBJNR', 'aufk_ERDAT': 'ERDAT', 'aufk_ERNAM': 'ERNAM', 'aufk_AUART': 'AUART', 'aufk_ZZGLTRP_ORIG': 'ZZGLTRP_ORIG', 'aufk_ZZPRO_TEXT': 'ZZPRO_TEXT', 'mara_global_material_number': 'global_material_number', 'mara_NTGEW': 'NTGEW', 'mara_MTART': 'MTART'}
2024-12-01 15:33:45,128 - code.main - INFO - Successfully removed prefixes from column names
2024-12-01 15:33:45,128 - code.main - INFO - Removed prefixes from column names.
2024-12-01 15:33:45,128 - code.main - INFO - Integration of DataFrames completed successfully.
2024-12-01 15:33:45,128 - code.main - INFO - Post-processing process order.
2024-12-01 15:33:45,128 - code.main - INFO - Starting post-processing of order data.
2024-12-01 15:33:45,128 - code.main - INFO - Starting derivation of intra and inter primary keys
2024-12-01 15:33:45,128 - code.main - INFO - Using columns ['AUFNR', 'POSNR', 'DWERK'] for primary key generation
2024-12-01 15:33:45,128 - code.main - INFO - Source system column: SOURCE_SYSTEM_ERP
2024-12-01 15:33:45,143 - code.main - INFO - Generated intra primary key: primary_key_intra
2024-12-01 15:33:45,157 - code.main - INFO - Generated inter primary key: primary_key_inter
2024-12-01 15:33:45,157 - code.main - INFO - Completed derivation of intra and inter primary keys
2024-12-01 15:33:45,189 - code.main - INFO - Date columns are converted to date format.
2024-12-01 15:33:45,213 - code.main - INFO - On-time flag is created.
2024-12-01 15:33:45,233 - code.main - INFO - Actual on-time deviation column is created.
2024-12-01 15:33:45,252 - code.main - INFO - Late delivery bucket is created.
2024-12-01 15:33:45,266 - code.main - INFO - MTO vs MTS flag is created.
2024-12-01 15:33:45,298 - code.main - INFO - Order timestamp columns are created.
2024-12-01 15:33:45,298 - code.main - INFO - Post-processing of order data completed successfully.
2024-12-01 15:33:45,298 - code.main - INFO - Validating and writing final dataframe.
2024-12-01 15:33:45,298 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:33:45,298 - code.main - INFO - Writing the data for system: PRD and table_name: PROCESS_ORDER_SCHEMA
2024-12-01 15:33:45,298 - code.main - INFO - DataFrame schema matches the expected schema.
2024-12-01 15:33:46,722 - code.main - INFO - DataFrame successfully written to path: ./output/PRD/PROCESS_ORDER_SCHEMA/
2024-12-01 15:33:46,722 - code.main - INFO - status of validate and write: True
2024-12-01 15:33:46,722 - code.main - INFO - Process Order processing complete for system: PRD
2024-12-01 15:33:46,722 - code.main - INFO - Harmonizing Local Material data between PRE and PRD systems.
2024-12-01 15:33:46,722 - code.main - INFO - Schema matched.
2024-12-01 15:33:46,972 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MATNR', StringType(), True), StructField('WERKS', StringType(), True), StructField('MEINS', StringType(), True), StructField('global_material_number', StringType(), True), StructField('BWKEY', StringType(), True), StructField('NAME1', StringType(), True), StructField('VPRSV', StringType(), True), StructField('VERPR', DoubleType(), True), StructField('STPRS', DoubleType(), True), StructField('PEINH', DoubleType(), True), StructField('BKLAS', StringType(), True), StructField('WAERS', StringType(), True), StructField('mtl_plant_emd', StringType(), False), StructField('global_mtl_id', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('no_of_duplicates', LongType(), False)])
2024-12-01 15:33:46,972 - code.main - INFO - Writing the data for system: None and table_name: local_material
2024-12-01 15:33:51,001 - code.main - INFO - DataFrame successfully written to path: ./output//local_material/
2024-12-01 15:33:51,001 - code.main - INFO - Harmonization of Local Material data was successful.
2024-12-01 15:33:51,002 - code.main - INFO - Harmonizing Process Order data between PRE and PRD systems.
2024-12-01 15:33:51,002 - code.main - INFO - Schema matched.
2024-12-01 15:33:51,125 - code.main - INFO - Input DataFrame schema:
StructType([StructField('SOURCE_SYSTEM_ERP', StringType(), True), StructField('MANDT', StringType(), True), StructField('GLTRP', DateType(), True), StructField('GSTRP', DateType(), True), StructField('FTRMS', DateType(), True), StructField('GLTRS', DateType(), True), StructField('GSTRS', DateType(), True), StructField('GSTRI', DateType(), True), StructField('GETRI', DateType(), True), StructField('GLTRI', DateType(), True), StructField('FTRMI', DateType(), True), StructField('FTRMP', DateType(), True), StructField('DISPO', StringType(), True), StructField('FEVOR', StringType(), True), StructField('PLGRP', StringType(), True), StructField('FHORI', StringType(), True), StructField('AUFPL', StringType(), True), StructField('start_date', DateType(), True), StructField('finish_date', DateType(), True), StructField('POSNR', StringType(), True), StructField('DWERK', StringType(), True), StructField('MEINS', StringType(), True), StructField('KDAUF', StringType(), True), StructField('KDPOS', StringType(), True), StructField('AUFNR', StringType(), True), StructField('OBJNR', StringType(), True), StructField('ERDAT', DateType(), True), StructField('ERNAM', StringType(), True), StructField('AUART', StringType(), True), StructField('ZZGLTRP_ORIG', DateType(), True), StructField('ZZPRO_TEXT', StringType(), True), StructField('global_material_number', StringType(), True), StructField('NTGEW', DoubleType(), True), StructField('MTART', StringType(), True), StructField('primary_key_intra', StringType(), False), StructField('primary_key_inter', StringType(), False), StructField('on_time_flag', IntegerType(), True), StructField('actual_on_time_deviation', IntegerType(), True), StructField('late_delivery_bucket', StringType(), True), StructField('mto_vs_mts_flag', StringType(), False), StructField('order_finish_timestamp', TimestampType(), True), StructField('order_start_timestamp', TimestampType(), True)])
2024-12-01 15:33:51,125 - code.main - INFO - Writing the data for system: None and table_name: process_order
2024-12-01 15:33:54,142 - code.main - INFO - DataFrame successfully written to path: ./output//process_order/
2024-12-01 15:33:54,142 - code.main - INFO - Harmonization of Process Order data was successful.
2024-12-01 15:33:54,142 - py4j.clientserver - INFO - Closing down clientserver connection
